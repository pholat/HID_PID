cscope 15 $HOME/workspace/HID_PID -q 0000000961 0000075584
	@AVR_Code/adc.c

9 
	~"adc.h
"

11 
	$adc_Ú
(
ušt8_t
 
muÉËx”
,ušt8_ˆ
¡©us
)

13 
ADMUX
|=
muÉËx”
;

14 
ušt8_t
 
a
=1;

15 
ušt8_t
 
i
=0;

16 
ušt16_t
 
şock
=
F_CPU
/1000;

17 
şock
/
a
>200) {

18 
a
=(a<<1);

19 
i
++;

21 if(
i
>7) i=7;

22 
ADCSRA
|=
i
;

23 
ADCSRA
|=
¡©us
;

24 
	}
}

26 
ušt16_t
 
	$adc_Úe
(
ušt8_t
 
pš
)

28 
ADMUX
&=~((1<<
MUX0
)|(1<<
MUX1
)|(1<<
MUX2
));

29 
ADMUX
|=
pš
;

30 
ADCSRA
|=(1<<
ADSC
);

31 
ADCSRA
&(1<<
ADSC
));

32 if(
ADMUX
&(1<<
ADLAR
)è 
ADCH
;

33  
ADC
;

35 
	}
}

37 
ušt16_t
 * 
	$adc_muÉË
(
ušt8_t
 
pšs
)

39 
ušt16_t
 
w®ues
[7];

40 
ušt8_t
 
i
=0; i<6; i++èif(
pšs
&(1<<i)è
w®ues
[i]=
	`adc_Úe
(i);

41  
w®ues
;

42 
	}
}

44 
	$adc_off
()

46 
ADCSRA
&=~(1<<
ADEN
);

47 
	}
}

	@AVR_Code/adc.h

8 #iâdeà
ADC_H_


9 
	#ADC_H_


	)

11 
	~<avr/io.h
>

12 
	~<avr/š‹¼u±.h
>

13 
	~<ut/d–ay.h
>

15 
adc_Ú
(
ušt8_t
 
muÉËx”
,ušt8_ˆ
¡©us
);

16 
ušt16_t
 
adc_Úe
(
ušt8_t
 
pš
);

17 
ušt16_t
 * 
adc_muÉË
(
ušt8_t
 
pšs
) ;

18 
adc_off
();

	@AVR_Code/ascii.h

8 #iâdeà
ASCII_H_


9 
	#ASCII_H_


	)

11 cÚ¡ 
ušt8_t
 
	gASCII
[][5] = {

	@AVR_Code/main.c

16 
	~<avr/io.h
>

17 
	~<avr/š‹¼u±.h
>

18 
	~<avr/wdt.h
>

19 
	~"usbdrv/usbdrv.h
"

20 
	~<ut/d–ay.h
>

21 
	~"adc.h
"

26 
	#DATA_READY
 (1<<0)

	)

27 
	#ONE_SECOND
 (1<<1)

	)

28 
	#NEW_DATA
 (1<<2)

	)

29 
ušt8_t
 vŞ©
	gæag
 = 0;

30 
	#USB_DATA_SIZE
 8

32 

	)

33 
	#USB_DATA_OUT
 2

34 
	#USB_DATA_IN
 4

35 

	)

36 
	ebufãrBy‹
 {

37 
	mFÏg
,
	mTempYoungADC
,
	mTempOldADC
,
	mTempYoungS‘
,
	mTempOldS‘
,
	mPID_P
,
	mPID_I
,
	mPID_D


40 vŞ©
ušt8_t
 
	g»¶yBuf
[
USB_DATA_SIZE
]= {0,0,0,0,0,0,0,0};

41 
uch¬
 
	gd©aReûived
 = 0, 
	gd©aL’gth
 = 0;

43 
	uTwoBy‹s
 {

44 
ušt16_t
 
	mu16
;

45 
ušt8_t
 
	mu8
[2];

46 } 
	gTempS‘
;

49 
USB_PUBLIC
 
uch¬
 
	$usbFunùiÚS‘up
(
uch¬
 *
d©a
)

51 
usbReque¡_t
 *
rq
 = (*)
d©a
;

53 
rq
->
bReque¡
) {

60 
USB_DATA_OUT
:

61 
usbMsgPŒ
 = 
»¶yBuf
;

62  (
»¶yBuf
);

69 
USB_DATA_IN
:

70 
d©aL’gth
 = (
uch¬
)
rq
->
wL’gth
.
wÜd
;

71 
d©aReûived
 = 0;

73 if(
d©aL’gth
 > (
»¶yBuf
))

74 
d©aL’gth
 = (
»¶yBuf
);

75  
USB_NO_MSG
;

79 
	}
}

82 
USB_PUBLIC
 
uch¬
 
	$usbFunùiÚWr™e
(
uch¬
 *
d©a
, uch¬ 
Ën
)

84 
uch¬
 
i
;

86 
i
 = 0; 
d©aReûived
 < 
d©aL’gth
 && i < 
Ën
; i++, dataReceived++) {

88 if(
i
!=
TempOldADC
 || i!=
TempYoungADC
è
»¶yBuf
[
d©aReûived
] = 
d©a
[i];

90  (
d©aReûived
 =ğ
d©aL’gth
);

91 
	}
}

94 
	$maš
()

96 
»¶yBuf
[
TempOldS‘
]=0x03;

97 
»¶yBuf
[
TempYoungS‘
]=0xFF;

99 
uch¬
 
i
;

100 
DDRC
&=~(1<<
PC5
);

101 
PORTC
&=~(1<<
PC5
);

102 
DDRC
|=(1<<
PC1
)|(1<<
PC2
)|(1<<
PC3
)|(1<<
PC4
);

103 
PORTC
&=~(1<<
PC2
);

104 
PORTC
|=(1<<
PC1
);

107 
	`adc_Ú
(5|(1<<
REFS0
),(1<<
ADEN
)|(1<<
ADSC
) );

110 
	`wdt_’abË
(
WDTO_1S
);

111 
	`usbIn™
();

112 
	`usbDeviûDiscÚÃù
();

113 
i
 = 0; i<250; i++) {

114 
	`wdt_»£t
();

115 
	`_d–ay_ms
(2);

117 
	`usbDeviûCÚÃù
();

118 
	`£i
();

119 
ušt16_t
 
couÁ”
=1;

122 
	`wdt_»£t
();

123 
ušt16_t
 
šU£ADCv®
=
	`adc_Úe
(5);

128 
»¶yBuf
[
TempOldADC
]=(
ADC
>>8)&0x03;

129 
»¶yBuf
[
TempYoungADC
]=(
ADC
&0xFF);

132 if((
couÁ”
==1)) {

133 
TempS‘
.
u8
[1]=
»¶yBuf
[
TempOldS‘
];

134 
TempS‘
.
u8
[0]=
»¶yBuf
[
TempYoungS‘
];

135 if(
šU£ADCv®
>
TempS‘
.
u16
è
PORTC
|=(1<<
PC4
);

137 
PORTC
&=~(1<<
PC4
);

138 
PORTC
|=(1<<
PC3
);

140 
couÁ”
=250;

142 
couÁ”
--;

143 
	`_d–ay_ms
(1);

157 
	`usbPŞl
();

160 
	}
}

	@AVR_Code/temptable.h

8 #iâdeà
TEMPTABLE_H_


9 
	#TEMPTABLE_H_


	)

11 
ušt16_t
 
	g‹mpTabË
[]= {

17 
ušt8_t
 
	gd–tTabË
[]= {

22 
ušt16_t
 
	$fšd_‹mp
(
ušt16_t
 
ADC
)

24 
ušt16_t
 
‹m³¿tu»
=300;

26  
‹m³¿tu»
;

27 
	}
}

	@AVR_Code/usbdrv/oddebug.c

10 
	~"oddebug.h
"

12 #ià
DEBUG_LEVEL
 > 0

16 
	$u¬tPutc
(
c
)

18 !(
ODDBG_USR
 & (1 << 
ODDBG_UDRE
)));

19 
ODDBG_UDR
 = 
c
;

20 
	}
}

22 
uch¬
 
	$hexAscii
(
uch¬
 
h
)

24 
h
 &= 0xf;

25 if(
h
 >= 10)

26 
h
 +ğ'a' - (
uch¬
)10 - '0';

27 
h
 += '0';

28  
h
;

29 
	}
}

31 
	$´štHex
(
uch¬
 
c
)

33 
	`u¬tPutc
(
	`hexAscii
(
c
 >> 4));

34 
	`u¬tPutc
(
	`hexAscii
(
c
));

35 
	}
}

37 
	$odDebug
(
uch¬
 
´efix
, uch¬ *
d©a
, uch¬ 
Ën
)

39 
	`´štHex
(
´efix
);

40 
	`u¬tPutc
(':');

41 
Ën
--) {

42 
	`u¬tPutc
(' ');

43 
	`´štHex
(*
d©a
++);

45 
	`u¬tPutc
('\r');

46 
	`u¬tPutc
('\n');

47 
	}
}

	@AVR_Code/usbdrv/oddebug.h

10 #iâdeà
__oddebug_h_šşuded__


11 
	#__oddebug_h_šşuded__


	)

26 #iâdeà
F_CPU


27 
	#F_CPU
 12000000

	)

31 
	~"usbpÜb™y.h
"

33 #iâdeà
uch¬


34 
	#uch¬
 

	)

37 #ià
DEBUG_LEVEL
 > 0 && !(
defšed
 
TXEN
 || defšed 
TXEN0
)

39 #undeà
DEBUG_LEVEL


42 #iâdeà
DEBUG_LEVEL


43 
	#DEBUG_LEVEL
 0

	)

48 #ià
DEBUG_LEVEL
 > 0

49 
	#DBG1
(
´efix
, 
d©a
, 
Ën
è
	`odDebug
Õ»fix, d©a,†’)

	)

51 
	#DBG1
(
´efix
, 
d©a
, 
Ën
)

	)

54 #ià
DEBUG_LEVEL
 > 1

55 
	#DBG2
(
´efix
, 
d©a
, 
Ën
è
	`odDebug
Õ»fix, d©a,†’)

	)

57 
	#DBG2
(
´efix
, 
d©a
, 
Ën
)

	)

62 #ià
DEBUG_LEVEL
 > 0

63 
odDebug
(
uch¬
 
´efix
, uch¬ *
d©a
, uch¬ 
Ën
);

67 #ià
defšed
 
UBRR


68 
	#ODDBG_UBRR
 
UBRR


	)

69 #–ià
defšed
 
UBRRL


70 
	#ODDBG_UBRR
 
UBRRL


	)

71 #–ià
defšed
 
UBRR0


72 
	#ODDBG_UBRR
 
UBRR0


	)

73 #–ià
defšed
 
UBRR0L


74 
	#ODDBG_UBRR
 
UBRR0L


	)

77 #ià
defšed
 
UCR


78 
	#ODDBG_UCR
 
UCR


	)

79 #–ià
defšed
 
UCSRB


80 
	#ODDBG_UCR
 
UCSRB


	)

81 #–ià
defšed
 
UCSR0B


82 
	#ODDBG_UCR
 
UCSR0B


	)

85 #ià
defšed
 
TXEN


86 
	#ODDBG_TXEN
 
TXEN


	)

88 
	#ODDBG_TXEN
 
TXEN0


	)

91 #ià
defšed
 
USR


92 
	#ODDBG_USR
 
USR


	)

93 #–ià
defšed
 
UCSRA


94 
	#ODDBG_USR
 
UCSRA


	)

95 #–ià
defšed
 
UCSR0A


96 
	#ODDBG_USR
 
UCSR0A


	)

99 #ià
defšed
 
UDRE


100 
	#ODDBG_UDRE
 
UDRE


	)

102 
	#ODDBG_UDRE
 
UDRE0


	)

105 #ià
defšed
 
UDR


106 
	#ODDBG_UDR
 
UDR


	)

107 #–ià
defšed
 
UDR0


108 
	#ODDBG_UDR
 
UDR0


	)

111 
šlše
 
	$odDebugIn™
()

113 
ODDBG_UCR
 |ğ(1<<
ODDBG_TXEN
);

114 
ODDBG_UBRR
 = 
F_CPU
 / (19200 * 16L) - 1;

115 
	}
}

117 
	#odDebugIn™
()

	)

	@AVR_Code/usbdrv/usbconfig.h

10 #iâdeà
__usbcÚfig_h_šşuded__


11 
	#__usbcÚfig_h_šşuded__


	)

28 
	#USB_CFG_IOPORTNAME
 
D


	)

32 
	#USB_CFG_DMINUS_BIT
 0

	)

36 
	#USB_CFG_DPLUS_BIT
 3

	)

45 
	#USB_CFG_CLOCK_KHZ
 12000

	)

54 
	#USB_CFG_CHECK_CRC
 0

	)

77 
	#USB_CFG_HAVE_INTRIN_ENDPOINT
 0

	)

82 
	#USB_CFG_HAVE_INTRIN_ENDPOINT3
 0

	)

88 
	#USB_CFG_EP3_NUMBER
 3

	)

98 
	#USB_CFG_IMPLEMENT_HALT
 0

	)

104 
	#USB_CFG_SUPPRESS_INTR_CODE
 0

	)

112 
	#USB_CFG_INTR_POLL_INTERVAL
 10

	)

117 
	#USB_CFG_IS_SELF_POWERED
 0

	)

121 
	#USB_CFG_MAX_BUS_POWER
 120

	)

126 
	#USB_CFG_IMPLEMENT_FN_WRITE
 1

	)

131 
	#USB_CFG_IMPLEMENT_FN_READ
 0

	)

137 
	#USB_CFG_IMPLEMENT_FN_WRITEOUT
 0

	)

143 
	#USB_CFG_HAVE_FLOWCONTROL
 0

	)

148 
	#USB_CFG_DRIVER_FLASH_PAGE
 0

	)

153 
	#USB_CFG_LONG_TRANSFERS
 0

	)

174 
	#USB_COUNT_SOF
 0

	)

198 
	#USB_CFG_CHECK_DATA_TOGGLING
 0

	)

206 
	#USB_CFG_HAVE_MEASURE_FRAME_LENGTH
 0

	)

210 
	#USB_USE_FAST_CRC
 0

	)

221 
	#USB_CFG_VENDOR_ID
 0xc0, 0x16

	)

230 
	#USB_CFG_DEVICE_ID
 0xdc, 0x05

	)

241 
	#USB_CFG_DEVICE_VERSION
 0x00, 0x01

	)

244 
	#USB_CFG_VENDOR_NAME
 'P', 'h', 'l', 't', '_', 'm', '8', 'b', 'r', 'd'

	)

245 
	#USB_CFG_VENDOR_NAME_LEN
 10

	)

254 
	#USB_CFG_DEVICE_NAME
 'T', 'e', 's', 't'

	)

255 
	#USB_CFG_DEVICE_NAME_LEN
 4

	)

269 
	#USB_CFG_DEVICE_CLASS
 0xfà

	)

270 
	#USB_CFG_DEVICE_SUBCLASS
 0

	)

274 
	#USB_CFG_INTERFACE_CLASS
 0

	)

275 
	#USB_CFG_INTERFACE_SUBCLASS
 0

	)

276 
	#USB_CFG_INTERFACE_PROTOCOL
 0

	)

347 
	#USB_CFG_DESCR_PROPS_DEVICE
 0

	)

348 
	#USB_CFG_DESCR_PROPS_CONFIGURATION
 0

	)

349 
	#USB_CFG_DESCR_PROPS_STRINGS
 0

	)

350 
	#USB_CFG_DESCR_PROPS_STRING_0
 0

	)

351 
	#USB_CFG_DESCR_PROPS_STRING_VENDOR
 0

	)

352 
	#USB_CFG_DESCR_PROPS_STRING_PRODUCT
 0

	)

353 
	#USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 0

	)

354 
	#USB_CFG_DESCR_PROPS_HID
 0

	)

355 
	#USB_CFG_DESCR_PROPS_HID_REPORT
 0

	)

356 
	#USB_CFG_DESCR_PROPS_UNKNOWN
 0

	)

359 
	#usbMsgPŒ_t
 

	)

376 
	#USB_INTR_CFG_SET
 ((1 << 
ISC10
è| (1 << 
ISC11
))

	)

377 
	#USB_INTR_CFG_CLR
 0

	)

379 
	#USB_INTR_ENABLE_BIT
 
INT1


	)

381 
	#USB_INTR_PENDING_BIT
 
INTF1


	)

382 
	#USB_INTR_VECTOR
 
INT1_veù


	)

	@AVR_Code/usbdrv/usbdrv.c

10 
	~"usbdrv.h
"

11 
	~"oddebug.h
"

22 
uch¬
 
	gusbRxBuf
[2*
USB_BUFSIZE
];

23 
uch¬
 
	gusbIÅutBufOff£t
;

24 
uch¬
 
	gusbDeviûAddr
;

25 
uch¬
 
	gusbNewDeviûAddr
;

26 
uch¬
 
	gusbCÚfigu¿tiÚ
;

27 vŞ©
sch¬
 
	gusbRxL’
;

28 
uch¬
 
	gusbCu¼’tTok
;

29 
uch¬
 
	gusbRxTok’
;

30 vŞ©
uch¬
 
	gusbTxL’
 = 
USBPID_NAK
;

31 
uch¬
 
	gusbTxBuf
[
USB_BUFSIZE
];

32 #ià
USB_COUNT_SOF


33 vŞ©
uch¬
 
	gusbSofCouÁ
;

35 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT
 && !
USB_CFG_SUPPRESS_INTR_CODE


36 
usbTxStus_t
 
	gusbTxStus1
;

37 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


38 
usbTxStus_t
 
	gusbTxStus3
;

41 #ià
USB_CFG_CHECK_DATA_TOGGLING


42 
uch¬
 
	gusbCu¼’tD©aTok’
;

46 
usbMsgPŒ_t
 
	gusbMsgPŒ
;

47 
usbMsgL’_t
 
	gusbMsgL’
 = 
USB_NO_MSG
;

48 
uch¬
 
	gusbMsgFÏgs
;

50 
	#USB_FLG_MSGPTR_IS_ROM
 (1<<6)

	)

51 
	#USB_FLG_USE_USER_RW
 (1<<7)

	)

63 #ià
USB_CFG_DESCR_PROPS_STRINGS
 == 0

65 #ià
USB_CFG_DESCR_PROPS_STRING_0
 == 0

66 #undeà
USB_CFG_DESCR_PROPS_STRING_0


67 
	#USB_CFG_DESCR_PROPS_STRING_0
 (
usbDesütÜSŒšg0
)

	)

68 
PROGMEM
 cÚ¡ 
	gusbDesütÜSŒšg0
[] = {

75 #ià
USB_CFG_DESCR_PROPS_STRING_VENDOR
 =ğ0 && 
USB_CFG_VENDOR_NAME_LEN


76 #undeà
USB_CFG_DESCR_PROPS_STRING_VENDOR


77 
	#USB_CFG_DESCR_PROPS_STRING_VENDOR
 (
usbDesütÜSŒšgV’dÜ
)

	)

78 
PROGMEM
 cÚ¡ 
	gusbDesütÜSŒšgV’dÜ
[] = {

79 
USB_STRING_DESCRIPTOR_HEADER
(
USB_CFG_VENDOR_NAME_LEN
),

80 
USB_CFG_VENDOR_NAME


84 #ià
USB_CFG_DESCR_PROPS_STRING_PRODUCT
 =ğ0 && 
USB_CFG_DEVICE_NAME_LEN


85 #undeà
USB_CFG_DESCR_PROPS_STRING_PRODUCT


86 
	#USB_CFG_DESCR_PROPS_STRING_PRODUCT
 (
usbDesütÜSŒšgDeviû
)

	)

87 
PROGMEM
 cÚ¡ 
	gusbDesütÜSŒšgDeviû
[] = {

88 
USB_STRING_DESCRIPTOR_HEADER
(
USB_CFG_DEVICE_NAME_LEN
),

89 
USB_CFG_DEVICE_NAME


93 #ià
USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 =ğ0 && 
USB_CFG_SERIAL_NUMBER_LEN


94 #undeà
USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER


95 
	#USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 (
usbDesütÜSŒšgS”ŸlNumb”
)

	)

96 
PROGMEM
 cÚ¡ 
	gusbDesütÜSŒšgS”ŸlNumb”
[] = {

97 
USB_STRING_DESCRIPTOR_HEADER
(
USB_CFG_SERIAL_NUMBER_LEN
),

98 
USB_CFG_SERIAL_NUMBER


106 #ià
USB_CFG_DESCR_PROPS_DEVICE
 == 0

107 #undeà
USB_CFG_DESCR_PROPS_DEVICE


108 
	#USB_CFG_DESCR_PROPS_DEVICE
 (
usbDesütÜDeviû
)

	)

109 
PROGMEM
 cÚ¡ 
	gusbDesütÜDeviû
[] = {

111 
USBDESCR_DEVICE
,

113 
USB_CFG_DEVICE_CLASS
,

114 
USB_CFG_DEVICE_SUBCLASS
,

120 ()
USB_CFG_VENDOR_ID
,

121 ()
USB_CFG_DEVICE_ID
,

122 
USB_CFG_DEVICE_VERSION
,

123 
USB_CFG_DESCR_PROPS_STRING_VENDOR
 != 0 ? 1 : 0,

124 
	gUSB_CFG_DESCR_PROPS_STRING_PRODUCT
 != 0 ? 2 : 0,

125 
	gUSB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 != 0 ? 3 : 0,

132 #ià
USB_CFG_DESCR_PROPS_HID_REPORT
 !ğ0 && 
USB_CFG_DESCR_PROPS_HID
 == 0

133 #undeà
USB_CFG_DESCR_PROPS_HID


134 
	#USB_CFG_DESCR_PROPS_HID
 9

	)

137 #ià
USB_CFG_DESCR_PROPS_CONFIGURATION
 == 0

138 #undeà
USB_CFG_DESCR_PROPS_CONFIGURATION


139 
	#USB_CFG_DESCR_PROPS_CONFIGURATION
 (
usbDesütÜCÚfigu¿tiÚ
)

	)

140 
PROGMEM
 cÚ¡ 
	gusbDesütÜCÚfigu¿tiÚ
[] = {

142 
USBDESCR_CONFIG
,

143 18 + 7 * 
USB_CFG_HAVE_INTRIN_ENDPOINT
 + 7 * 
USB_CFG_HAVE_INTRIN_ENDPOINT3
 +

144 (
USB_CFG_DESCR_PROPS_HID
 & 0xff), 0,

149 #ià
USB_CFG_IS_SELF_POWERED


150 (1 << 7è| 
USBATTR_SELFPOWER
,

154 
USB_CFG_MAX_BUS_POWER
/2,

157 
USBDESCR_INTERFACE
,

160 
USB_CFG_HAVE_INTRIN_ENDPOINT
 + 
USB_CFG_HAVE_INTRIN_ENDPOINT3
,

161 
USB_CFG_INTERFACE_CLASS
,

162 
USB_CFG_INTERFACE_SUBCLASS
,

163 
USB_CFG_INTERFACE_PROTOCOL
,

165 #ià(
USB_CFG_DESCR_PROPS_HID
 & 0xff)

167 
USBDESCR_HID
,

172 
USB_CFG_HID_REPORT_DESCRIPTOR_LENGTH
, 0,

174 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT


176 
USBDESCR_ENDPOINT
,

180 
USB_CFG_INTR_POLL_INTERVAL
,

182 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


184 
USBDESCR_ENDPOINT
,

185 ()(0x80 | 
USB_CFG_EP3_NUMBER
),

188 
USB_CFG_INTR_POLL_INTERVAL
,

195 
šlše
 
	$usbRe£tD©aTogglšg
()

197 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT
 && !
USB_CFG_SUPPRESS_INTR_CODE


198 
	`USB_SET_DATATOKEN1
(
USB_INITIAL_DATATOKEN
);

199 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


200 
	`USB_SET_DATATOKEN3
(
USB_INITIAL_DATATOKEN
);

203 
	}
}

205 
šlše
 
	$usbRe£tSÎ
()

207 #ià
USB_CFG_IMPLEMENT_HALT
 && 
USB_CFG_HAVE_INTRIN_ENDPOINT


208 
usbTxL’1
 = 
USBPID_NAK
;

209 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


210 
usbTxL’3
 = 
USBPID_NAK
;

213 
	}
}

217 #ià!
USB_CFG_SUPPRESS_INTR_CODE


218 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT


219 
	$usbG’”icS‘IÁ”ru±
(
uch¬
 *
d©a
, uch¬ 
Ën
, 
usbTxStus_t
 *
txStus
)

221 
uch¬
 *
p
;

222 
i
;

224 #ià
USB_CFG_IMPLEMENT_HALT


225 if(
usbTxL’1
 =ğ
USBPID_STALL
)

228 if(
txStus
->
Ën
 & 0x10) {

229 
txStus
->
bufãr
[0] ^ğ
USBPID_DATA0
 ^ 
USBPID_DATA1
;

231 
txStus
->
Ën
 = 
USBPID_NAK
;

233 
p
 = 
txStus
->
bufãr
 + 1;

234 
i
 = 
Ën
;

236 *
p
++ = *
d©a
++;

237 } --
i
 > 0);

238 
	`usbCrc16Aµ’d
(&
txStus
->
bufãr
[1], 
Ën
);

239 
txStus
->
Ën
 =†en + 4;

240 
	`DBG2
(0x21 + ((()
txStus
 >> 3è& 3),xStus->
bufãr
, 
Ën
 + 3);

241 
	}
}

243 
USB_PUBLIC
 
	$usbS‘IÁ”ru±
(
uch¬
 *
d©a
, uch¬ 
Ën
)

245 
	`usbG’”icS‘IÁ”ru±
(
d©a
, 
Ën
, &
usbTxStus1
);

246 
	}
}

249 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


250 
USB_PUBLIC
 
	$usbS‘IÁ”ru±3
(
uch¬
 *
d©a
, uch¬ 
Ën
)

252 
	`usbG’”icS‘IÁ”ru±
(
d©a
, 
Ën
, &
usbTxStus3
);

253 
	}
}

264 #ià
USB_CFG_USE_SWITCH_STATEMENT


265 
	#SWITCH_START
(
cmd
ècmd){{

	)

266 
	#SWITCH_CASE
(
v®ue
è}; (v®ue):{

	)

267 
	#SWITCH_CASE2
(
v1
,
v2
è}; (v1): (v2):{

	)

268 
	#SWITCH_CASE3
(
v1
,
v2
,
v3
è}; (v1): (v2): (v3):{

	)

269 
	#SWITCH_DEFAULT
 }; :{

	)

270 
	#SWITCH_END
 }}

	)

272 
	#SWITCH_START
(
cmd
è{
uch¬
 
_cmd
 = cmd; if(0){

	)

273 
	#SWITCH_CASE
(
v®ue
è}if(
_cmd
 =ğ(v®ue)){

	)

274 
	#SWITCH_CASE2
(
v1
,
v2
è}if(
_cmd
 =ğ(v1è|| _cmd =ğ(v2)){

	)

275 
	#SWITCH_CASE3
(
v1
,
v2
,
v3
è}if(
_cmd
 =ğ(v1è|| _cmd =ğ(v2è|| (_cmd =ğv3)){

	)

276 
	#SWITCH_DEFAULT
 }{

	)

277 
	#SWITCH_END
 }}

	)

280 #iâdeà
USB_RX_USER_HOOK


281 
	#USB_RX_USER_HOOK
(
d©a
, 
Ën
)

	)

283 #iâdeà
USB_SET_ADDRESS_HOOK


284 
	#USB_SET_ADDRESS_HOOK
()

	)

294 
	#GET_DESCRIPTOR
(
cfgPrİ
, 
¡©icName
) \

295 if(
cfgPrİ
){ \

296 if((
cfgPrİ
è& 
USB_PROP_IS_RAM
) \

297 
æags
 = 0; \

298 if((
cfgPrİ
è& 
USB_PROP_IS_DYNAMIC
){ \

299 
Ën
 = 
	`usbFunùiÚDesütÜ
(
rq
); \

301 
Ën
 = 
	`USB_PROP_LENGTH
(
cfgPrİ
); \

302 
usbMsgPŒ
 = (
usbMsgPŒ_t
)(
¡©icName
); \

304 }

	)

309 
šlše
 
usbMsgL’_t
 
	$usbDriv”DesütÜ
(
usbReque¡_t
 *
rq
)

311 
usbMsgL’_t
 
Ën
 = 0;

312 
uch¬
 
æags
 = 
USB_FLG_MSGPTR_IS_ROM
;

314 
	`SWITCH_START
(
rq
->
wV®ue
.
by‹s
[1])

315 
	`SWITCH_CASE
(
USBDESCR_DEVICE
)

316 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_DEVICE
, 
usbDesütÜDeviû
)

317 
	`SWITCH_CASE
(
USBDESCR_CONFIG
)

318 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_CONFIGURATION
, 
usbDesütÜCÚfigu¿tiÚ
)

319 
	`SWITCH_CASE
(
USBDESCR_STRING
)

320 #ià
USB_CFG_DESCR_PROPS_STRINGS
 & 
USB_PROP_IS_DYNAMIC


321 if(
USB_CFG_DESCR_PROPS_STRINGS
 & 
USB_PROP_IS_RAM
)

322 
æags
 = 0;

323 
Ën
 = 
	`usbFunùiÚDesütÜ
(
rq
);

325 
	`SWITCH_START
(
rq
->
wV®ue
.
by‹s
[0])

326 
	`SWITCH_CASE
(0)

327 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_STRING_0
, 
usbDesütÜSŒšg0
)

328 
	`SWITCH_CASE
(1)

329 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_STRING_VENDOR
, 
usbDesütÜSŒšgV’dÜ
)

330 
	`SWITCH_CASE
(2)

331 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_STRING_PRODUCT
, 
usbDesütÜSŒšgDeviû
)

332 
	`SWITCH_CASE
(3)

333 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
, 
usbDesütÜSŒšgS”ŸlNumb”
)

334 
SWITCH_DEFAULT


335 if(
USB_CFG_DESCR_PROPS_UNKNOWN
 & 
USB_PROP_IS_DYNAMIC
) {

336 
Ën
 = 
	`usbFunùiÚDesütÜ
(
rq
);

338 
SWITCH_END


340 #ià
USB_CFG_DESCR_PROPS_HID_REPORT


341 
	`SWITCH_CASE
(
USBDESCR_HID
)

342 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_HID
, 
usbDesütÜCÚfigu¿tiÚ
 + 18)

343 
	`SWITCH_CASE
(
USBDESCR_HID_REPORT
)

344 
	`GET_DESCRIPTOR
(
USB_CFG_DESCR_PROPS_HID_REPORT
, 
usbDesütÜHidR•Üt
)

346 
SWITCH_DEFAULT


347 if(
USB_CFG_DESCR_PROPS_UNKNOWN
 & 
USB_PROP_IS_DYNAMIC
) {

348 
Ën
 = 
	`usbFunùiÚDesütÜ
(
rq
);

350 
SWITCH_END


351 
usbMsgFÏgs
 = 
æags
;

352  
Ën
;

353 
	}
}

360 
šlše
 
usbMsgL’_t
 
	$usbDriv”S‘up
(
usbReque¡_t
 *
rq
)

362 
usbMsgL’_t
 
Ën
 = 0;

363 
uch¬
 *
d©aPŒ
 = 
usbTxBuf
 + 9;

364 
uch¬
 
v®ue
 = 
rq
->
wV®ue
.
by‹s
[0];

365 #ià
USB_CFG_IMPLEMENT_HALT


366 
uch¬
 
šdex
 = 
rq
->
wIndex
.
by‹s
[0];

369 
d©aPŒ
[0] = 0;

370 
	`SWITCH_START
(
rq
->
bReque¡
)

371 
	`SWITCH_CASE
(
USBRQ_GET_STATUS
)

372 
uch¬
 
»c›Á
 = 
rq
->
bmReque¡Ty³
 & 
USBRQ_RCPT_MASK
;

373 if(
USB_CFG_IS_SELF_POWERED
 && 
»c›Á
 =ğ
USBRQ_RCPT_DEVICE
)

374 
d©aPŒ
[0] = 
USB_CFG_IS_SELF_POWERED
;

375 #ià
USB_CFG_IMPLEMENT_HALT


376 if(
»c›Á
 =ğ
USBRQ_RCPT_ENDPOINT
 && 
šdex
 == 0x81)

377 
d©aPŒ
[0] = 
usbTxL’1
 =ğ
USBPID_STALL
;

379 
d©aPŒ
[1] = 0;

380 
Ën
 = 2;

381 #ià
USB_CFG_IMPLEMENT_HALT


382 
	`SWITCH_CASE2
(
USBRQ_CLEAR_FEATURE
, 
USBRQ_SET_FEATURE
)

383 if(
v®ue
 =ğ0 && 
šdex
 == 0x81) {

384 
usbTxL’1
 = 
rq
->
bReque¡
 =ğ
USBRQ_CLEAR_FEATURE
 ? 
USBPID_NAK
 : 
USBPID_STALL
;

385 
	`usbRe£tD©aTogglšg
();

388 
	`SWITCH_CASE
(
USBRQ_SET_ADDRESS
)

389 
usbNewDeviûAddr
 = 
v®ue
;

390 
	`USB_SET_ADDRESS_HOOK
();

391 
	`SWITCH_CASE
(
USBRQ_GET_DESCRIPTOR
)

392 
Ën
 = 
	`usbDriv”DesütÜ
(
rq
);

393 
skMsgPŒAssignm’t
;

394 
	`SWITCH_CASE
(
USBRQ_GET_CONFIGURATION
)

395 
d©aPŒ
 = &
usbCÚfigu¿tiÚ
;

396 
Ën
 = 1;

397 
	`SWITCH_CASE
(
USBRQ_SET_CONFIGURATION
)

398 
usbCÚfigu¿tiÚ
 = 
v®ue
;

399 
	`usbRe£tSÎ
();

400 
	`SWITCH_CASE
(
USBRQ_GET_INTERFACE
)

401 
Ën
 = 1;

402 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT
 && !
USB_CFG_SUPPRESS_INTR_CODE


403 
	`SWITCH_CASE
(
USBRQ_SET_INTERFACE
)

404 
	`usbRe£tD©aTogglšg
();

405 
	`usbRe£tSÎ
();

407 
SWITCH_DEFAULT


409 
SWITCH_END


410 
usbMsgPŒ
 = (
usbMsgPŒ_t
)
d©aPŒ
;

411 
skMsgPŒAssignm’t
:

412  
Ën
;

413 
	}
}

421 
šlše
 
	$usbProûssRx
(
uch¬
 *
d©a
, uch¬ 
Ën
)

423 
usbReque¡_t
 *
rq
 = (*)
d©a
;

430 
	`DBG2
(0x10 + (
usbRxTok’
 & 0xf), 
d©a
, 
Ën
 + 2);

431 
	`USB_RX_USER_HOOK
(
d©a
, 
Ën
)

432 #ià
USB_CFG_IMPLEMENT_FN_WRITEOUT


433 if(
usbRxTok’
 < 0x10) {

434 
	`usbFunùiÚWr™eOut
(
d©a
, 
Ën
);

438 if(
usbRxTok’
 =ğ(
uch¬
)
USBPID_SETUP
) {

439 if(
Ën
 != 8)

441 
usbMsgL’_t
 
»¶yL’
;

442 
usbTxBuf
[0] = 
USBPID_DATA0
;

443 
usbTxL’
 = 
USBPID_NAK
;

444 
usbMsgFÏgs
 = 0;

445 
uch¬
 
ty³
 = 
rq
->
bmReque¡Ty³
 & 
USBRQ_TYPE_MASK
;

446 if(
ty³
 !ğ
USBRQ_TYPE_STANDARD
) {

447 
»¶yL’
 = 
	`usbFunùiÚS‘up
(
d©a
);

449 
»¶yL’
 = 
	`usbDriv”S‘up
(
rq
);

451 #ià
USB_CFG_IMPLEMENT_FN_READ
 || 
USB_CFG_IMPLEMENT_FN_WRITE


452 if(
»¶yL’
 =ğ
USB_NO_MSG
) {

454 if((
rq
->
bmReque¡Ty³
 & 
USBRQ_DIR_MASK
è!ğ
USBRQ_DIR_HOST_TO_DEVICE
) {

455 if((
»¶yL’
è< (
rq
->
wL’gth
.
wÜd
)) {

456 
»¶yL’
 = 
rq
->
wL’gth
.
by‹s
[0];

458 
»¶yL’
 = 
rq
->
wL’gth
.
wÜd
;

461 
usbMsgFÏgs
 = 
USB_FLG_USE_USER_RW
;

464 if((
»¶yL’
è< (
rq
->
wL’gth
.
wÜd
)) {

465 if(!
rq
->
wL’gth
.
by‹s
[1] && 
»¶yL’
 >„q->wLength.bytes[0])

466 
»¶yL’
 = 
rq
->
wL’gth
.
by‹s
[0];

468 if(
»¶yL’
 > 
rq
->
wL’gth
.
wÜd
)

469 
»¶yL’
 = 
rq
->
wL’gth
.
wÜd
;

471 
usbMsgL’
 = 
»¶yL’
;

473 #ià
USB_CFG_IMPLEMENT_FN_WRITE


474 if(
usbMsgFÏgs
 & 
USB_FLG_USE_USER_RW
) {

475 
uch¬
 
rv®
 = 
	`usbFunùiÚWr™e
(
d©a
, 
Ën
);

476 if(
rv®
 == 0xff) {

477 
usbTxL’
 = 
USBPID_STALL
;

478 } if(
rv®
 != 0) {

479 
usbMsgL’
 = 0;

484 
	}
}

491 
uch¬
 
	$usbDeviûR—d
(
uch¬
 *
d©a
, uch¬ 
Ën
)

493 if(
Ën
 > 0) {

494 #ià
USB_CFG_IMPLEMENT_FN_READ


495 if(
usbMsgFÏgs
 & 
USB_FLG_USE_USER_RW
) {

496 
Ën
 = 
	`usbFunùiÚR—d
(
d©a
,†en);

500 
uch¬
 
i
 = 
Ën
;

501 
usbMsgPŒ_t
 
r
 = 
usbMsgPŒ
;

502 if(
usbMsgFÏgs
 & 
USB_FLG_MSGPTR_IS_ROM
) {

504 
uch¬
 
c
 = 
	`USB_READ_FLASH
(
r
);

505 *
d©a
++ = 
c
;

506 
r
++;

507 } --
i
);

510 *
d©a
++ = *((
uch¬
 *)
r
);

511 
r
++;

512 } --
i
);

514 
usbMsgPŒ
 = 
r
;

517  
Ën
;

518 
	}
}

525 
šlše
 
	$usbBudTxBlock
()

527 
usbMsgL’_t
 
wªtL’
;

528 
uch¬
 
Ën
;

530 
wªtL’
 = 
usbMsgL’
;

531 if(
wªtL’
 > 8)

532 
wªtL’
 = 8;

533 
usbMsgL’
 -ğ
wªtL’
;

534 
usbTxBuf
[0] ^ğ
USBPID_DATA0
 ^ 
USBPID_DATA1
;

535 
Ën
 = 
	`usbDeviûR—d
(
usbTxBuf
 + 1, 
wªtL’
);

536 if(
Ën
 <= 8) {

537 
	`usbCrc16Aµ’d
(&
usbTxBuf
[1], 
Ën
);

538 
Ën
 += 4;

539 if(
Ën
 < 12)

540 
usbMsgL’
 = 
USB_NO_MSG
;

542 
Ën
 = 
USBPID_STALL
;

543 
usbMsgL’
 = 
USB_NO_MSG
;

545 
usbTxL’
 = 
Ën
;

546 
	`DBG2
(0x20, 
usbTxBuf
, 
Ën
-1);

547 
	}
}

551 
šlše
 
	$usbHªdËRe£tHook
(
uch¬
 
nÙRe£tS‹
)

553 #ifdeà
USB_RESET_HOOK


554 
uch¬
 
wasRe£t
;

555 
uch¬
 
isRe£t
 = !
nÙRe£tS‹
;

557 if(
wasRe£t
 !ğ
isRe£t
) {

558 
	`USB_RESET_HOOK
(
isRe£t
);

559 
wasRe£t
 = 
isRe£t
;

562 
nÙRe£tS‹
 =‚otResetState;

564 
	}
}

568 
USB_PUBLIC
 
	$usbPŞl
()

570 
sch¬
 
Ën
;

571 
uch¬
 
i
;

573 
Ën
 = 
usbRxL’
 - 3;

574 if(
Ën
 >= 0) {

581 
	`usbProûssRx
(
usbRxBuf
 + 
USB_BUFSIZE
 + 1 - 
usbIÅutBufOff£t
, 
Ën
);

582 #ià
USB_CFG_HAVE_FLOWCONTROL


583 if(
usbRxL’
 > 0)

584 
usbRxL’
 = 0;

586 
usbRxL’
 = 0;

589 if(
usbTxL’
 & 0x10) {

590 if(
usbMsgL’
 !ğ
USB_NO_MSG
) {

591 
	`usbBudTxBlock
();

594 
i
 = 20; i > 0; i--) {

595 
uch¬
 
usbLšeStus
 = 
USBIN
 & 
USBMASK
;

596 if(
usbLšeStus
 != 0)

597 
isNÙRe£t
;

600 
usbNewDeviûAddr
 = 0;

601 
usbDeviûAddr
 = 0;

602 
	`usbRe£tSÎ
();

603 
	`DBG1
(0xff, 0, 0);

604 
isNÙRe£t
:

605 
	`usbHªdËRe£tHook
(
i
);

606 
	}
}

610 
USB_PUBLIC
 
	$usbIn™
()

612 #ià
USB_INTR_CFG_SET
 != 0

613 
USB_INTR_CFG
 |ğ
USB_INTR_CFG_SET
;

615 #ià
USB_INTR_CFG_CLR
 != 0

616 
USB_INTR_CFG
 &ğ~(
USB_INTR_CFG_CLR
);

618 
USB_INTR_ENABLE
 |ğ(1 << 
USB_INTR_ENABLE_BIT
);

619 
	`usbRe£tD©aTogglšg
();

620 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT
 && !
USB_CFG_SUPPRESS_INTR_CODE


621 
usbTxL’1
 = 
USBPID_NAK
;

622 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


623 
usbTxL’3
 = 
USBPID_NAK
;

626 
	}
}

	@AVR_Code/usbdrv/usbdrv.h

10 #iâdeà
__usbdrv_h_šşuded__


11 
	#__usbdrv_h_šşuded__


	)

12 
	~"usbcÚfig.h
"

13 
	~"usbpÜb™y.h
"

124 
	#USBDRV_VERSION
 20121206

	)

133 #iâdeà
USB_PUBLIC


134 
	#USB_PUBLIC


	)

143 #iâdeà
__ASSEMBLER__


144 #iâdeà
uch¬


145 
	#uch¬
 

	)

147 #iâdeà
sch¬


148 
	#sch¬
 sigÃd 

	)

152 #ià
USB_CFG_LONG_TRANSFERS


153 
	#usbMsgL’_t
 

	)

155 
	#usbMsgL’_t
 
uch¬


	)

163 
	#USB_NO_MSG
 ((
usbMsgL’_t
)-1è

	)

165 #iâdeà
usbMsgPŒ_t


166 
	#usbMsgPŒ_t
 
uch¬
 *

	)

176 
	gusbReque¡
;

178 
USB_PUBLIC
 
usbIn™
();

184 
USB_PUBLIC
 
usbPŞl
();

191 
usbMsgPŒ_t
 
usbMsgPŒ
;

196 
USB_PUBLIC
 
usbMsgL’_t
 
usbFunùiÚS‘up
(
uch¬
 
d©a
[8]);

223 
USB_PUBLIC
 
usbMsgL’_t
 
usbFunùiÚDesütÜ
(
usbReque¡
 *
rq
);

229 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT


230 
USB_PUBLIC
 
usbS‘IÁ”ru±
(
uch¬
 *
d©a
, uch¬ 
Ën
);

237 
	#usbIÁ”ru±IsR—dy
(è(
usbTxL’1
 & 0x10)

	)

242 #ià
USB_CFG_HAVE_INTRIN_ENDPOINT3


243 
USB_PUBLIC
 
usbS‘IÁ”ru±3
(
uch¬
 *
d©a
, uch¬ 
Ën
);

244 
	#usbIÁ”ru±IsR—dy3
(è(
usbTxL’3
 & 0x10)

	)

248 #ià
USB_CFG_HID_REPORT_DESCRIPTOR_LENGTH


249 
	#usbHidR•ÜtDesütÜ
 
usbDesütÜHidR•Üt


	)

258 #ià
USB_CFG_IMPLEMENT_FN_WRITE


259 
USB_PUBLIC
 
uch¬
 
usbFunùiÚWr™e
(uch¬ *
d©a
, uch¬ 
Ën
);

276 #ià
USB_CFG_IMPLEMENT_FN_READ


277 
USB_PUBLIC
 
uch¬
 
usbFunùiÚR—d
(uch¬ *
d©a
, uch¬ 
Ën
);

289 
uch¬
 
usbRxTok’
;

290 #ià
USB_CFG_IMPLEMENT_FN_WRITEOUT


291 
USB_PUBLIC
 
usbFunùiÚWr™eOut
(
uch¬
 *
d©a
, uch¬ 
Ën
);

298 #ifdeà
USB_CFG_PULLUP_IOPORTNAME


299 
	#usbDeviûCÚÃù
(è((
USB_PULLUP_DDR
 |ğ(1<<
USB_CFG_PULLUP_BIT
)), \

300 (
USB_PULLUP_OUT
 |ğ(1<<
USB_CFG_PULLUP_BIT
)))

	)

301 
	#usbDeviûDiscÚÃù
(è((
USB_PULLUP_DDR
 &ğ~(1<<
USB_CFG_PULLUP_BIT
)), \

302 (
USB_PULLUP_OUT
 &ğ~(1<<
USB_CFG_PULLUP_BIT
)))

	)

304 
	#usbDeviûCÚÃù
(è(
USBDDR
 &ğ~(1<<
USBMINUS
))

	)

305 
	#usbDeviûDiscÚÃù
(è(
USBDDR
 |ğ(1<<
USBMINUS
))

	)

319 
usbCrc16
(
d©a
, 
uch¬
 
Ën
);

320 
	#usbCrc16
(
d©a
, 
Ën
è
	`usbCrc16
(()(d©a),†’)

	)

327 
usbCrc16Aµ’d
(
d©a
, 
uch¬
 
Ën
);

328 
	#usbCrc16Aµ’d
(
d©a
, 
Ën
è
	`usbCrc16Aµ’d
(()(d©a),†’)

	)

333 #ià
USB_CFG_HAVE_MEASURE_FRAME_LENGTH


334 
usbM—su»F¿meL’gth
();

343 
uch¬
 
usbCÚfigu¿tiÚ
;

350 #ià
USB_COUNT_SOF


351 vŞ©
uch¬
 
usbSofCouÁ
;

356 #ià
USB_CFG_CHECK_DATA_TOGGLING


357 
uch¬
 
usbCu¼’tD©aTok’
;

363 
	#USB_STRING_DESCRIPTOR_HEADER
(
¡ršgL’gth
è((2*(¡ršgL’gth)+2è| (3<<8))

	)

367 #ià
USB_CFG_HAVE_FLOWCONTROL


368 vŞ©
sch¬
 
usbRxL’
;

369 
	#usbDi§bËAÎReque¡s
(è
usbRxL’
 = -1

	)

374 
	#usbEÇbËAÎReque¡s
(è
usbRxL’
 = 0

	)

378 
	#usbAÎReque¡sA»Di§bËd
(è(
usbRxL’
 < 0)

	)

385 
	#USB_SET_DATATOKEN1
(
tok’
è
usbTxBuf1
[0] = 
	)
tok’

386 
	#USB_SET_DATATOKEN3
(
tok’
è
usbTxBuf3
[0] = 
	)
tok’

403 
	#USB_PROP_IS_DYNAMIC
 (1u << 14)

	)

409 
	#USB_PROP_IS_RAM
 (1u << 15)

	)

414 
	#USB_PROP_LENGTH
(
Ën
è(Ö’è& 0x3fff)

	)

420 #iâdeà
USB_CFG_DESCR_PROPS_DEVICE


421 
	#USB_CFG_DESCR_PROPS_DEVICE
 0

	)

423 #iâdeà
USB_CFG_DESCR_PROPS_CONFIGURATION


424 
	#USB_CFG_DESCR_PROPS_CONFIGURATION
 0

	)

426 #iâdeà
USB_CFG_DESCR_PROPS_STRINGS


427 
	#USB_CFG_DESCR_PROPS_STRINGS
 0

	)

429 #iâdeà
USB_CFG_DESCR_PROPS_STRING_0


430 
	#USB_CFG_DESCR_PROPS_STRING_0
 0

	)

432 #iâdeà
USB_CFG_DESCR_PROPS_STRING_VENDOR


433 
	#USB_CFG_DESCR_PROPS_STRING_VENDOR
 0

	)

435 #iâdeà
USB_CFG_DESCR_PROPS_STRING_PRODUCT


436 
	#USB_CFG_DESCR_PROPS_STRING_PRODUCT
 0

	)

438 #iâdeà
USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER


439 
	#USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 0

	)

441 #iâdeà
USB_CFG_DESCR_PROPS_HID


442 
	#USB_CFG_DESCR_PROPS_HID
 0

	)

444 #ià!(
USB_CFG_DESCR_PROPS_HID_REPORT
)

445 #undeà
USB_CFG_DESCR_PROPS_HID_REPORT


446 #ià
USB_CFG_HID_REPORT_DESCRIPTOR_LENGTH


447 
	#USB_CFG_DESCR_PROPS_HID_REPORT
 
USB_CFG_HID_REPORT_DESCRIPTOR_LENGTH


	)

449 
	#USB_CFG_DESCR_PROPS_HID_REPORT
 0

	)

452 #iâdeà
USB_CFG_DESCR_PROPS_UNKNOWN


453 
	#USB_CFG_DESCR_PROPS_UNKNOWN
 0

	)

460 #iâdeà
__ASSEMBLER__


462 #ià!(
USB_CFG_DESCR_PROPS_DEVICE
 & 
USB_PROP_IS_RAM
)

463 
PROGMEM
 const

465 
usbDesütÜDeviû
[];

468 #ià!(
USB_CFG_DESCR_PROPS_CONFIGURATION
 & 
USB_PROP_IS_RAM
)

469 
PROGMEM
 const

471 
usbDesütÜCÚfigu¿tiÚ
[];

474 #ià!(
USB_CFG_DESCR_PROPS_HID_REPORT
 & 
USB_PROP_IS_RAM
)

475 
PROGMEM
 const

477 
usbDesütÜHidR•Üt
[];

480 #ià!(
USB_CFG_DESCR_PROPS_STRING_0
 & 
USB_PROP_IS_RAM
)

481 
PROGMEM
 const

483 
usbDesütÜSŒšg0
[];

486 #ià!(
USB_CFG_DESCR_PROPS_STRING_VENDOR
 & 
USB_PROP_IS_RAM
)

487 
PROGMEM
 const

489 
usbDesütÜSŒšgV’dÜ
[];

492 #ià!(
USB_CFG_DESCR_PROPS_STRING_PRODUCT
 & 
USB_PROP_IS_RAM
)

493 
PROGMEM
 const

495 
usbDesütÜSŒšgDeviû
[];

498 #ià!(
USB_CFG_DESCR_PROPS_STRING_SERIAL_NUMBER
 & 
USB_PROP_IS_RAM
)

499 
PROGMEM
 const

501 
usbDesütÜSŒšgS”ŸlNumb”
[];

509 
	#USB_CONCAT
(
a
, 
b
è¨## 
	)
b

510 
	#USB_CONCAT_EXPANDED
(
a
, 
b
è
	`USB_CONCAT
×, b)

	)

512 
	#USB_OUTPORT
(
Çme
è
	`USB_CONCAT
(
PORT
,‚ame)

	)

513 
	#USB_INPORT
(
Çme
è
	`USB_CONCAT
(
PIN
,‚ame)

	)

514 
	#USB_DDRPORT
(
Çme
è
	`USB_CONCAT
(
DDR
,‚ame)

	)

523 #ià!
defšed
 
__ASSEMBLER__
 && (!defšed 
USB_CFG_VENDOR_ID
 || !defšed 
USB_CFG_DEVICE_ID
)

531 #iâdeà
USB_CFG_VENDOR_ID


532 
	#USB_CFG_VENDOR_ID
 0xc0, 0x16

	)

535 #iâdeà
USB_CFG_DEVICE_ID


536 #ià
USB_CFG_HID_REPORT_DESCRIPTOR_LENGTH


537 
	#USB_CFG_DEVICE_ID
 0xdf, 0x05

	)

538 #–ià
USB_CFG_INTERFACE_CLASS
 == 2

539 
	#USB_CFG_DEVICE_ID
 0xe1, 0x05

	)

541 
	#USB_CFG_DEVICE_ID
 0xdc, 0x05

	)

546 #iâdeà
USB_CFG_IOPORTNAME


550 
	#USBOUT
 
	`USB_OUTPORT
(
USB_CFG_IOPORTNAME
)

	)

551 
	#USB_PULLUP_OUT
 
	`USB_OUTPORT
(
USB_CFG_PULLUP_IOPORTNAME
)

	)

552 
	#USBIN
 
	`USB_INPORT
(
USB_CFG_IOPORTNAME
)

	)

553 
	#USBDDR
 
	`USB_DDRPORT
(
USB_CFG_IOPORTNAME
)

	)

554 
	#USB_PULLUP_DDR
 
	`USB_DDRPORT
(
USB_CFG_PULLUP_IOPORTNAME
)

	)

556 
	#USBMINUS
 
USB_CFG_DMINUS_BIT


	)

557 
	#USBPLUS
 
USB_CFG_DPLUS_BIT


	)

558 
	#USBIDLE
 (1<<
USB_CFG_DMINUS_BIT
è

	)

559 
	#USBMASK
 ((1<<
USB_CFG_DPLUS_BIT
è| (1<<
USB_CFG_DMINUS_BIT
)è

	)

562 
	#USB_CFG_IOPORT
 
	`USB_OUTPORT
(
USB_CFG_IOPORTNAME
)

	)

563 #ifdeà
USB_CFG_PULLUP_IOPORTNAME


564 
	#USB_CFG_PULLUP_IOPORT
 
	`USB_OUTPORT
(
USB_CFG_PULLUP_IOPORTNAME
)

	)

567 #iâdeà
USB_CFG_EP3_NUMBER


568 
	#USB_CFG_EP3_NUMBER
 3

	)

571 #iâdeà
USB_CFG_HAVE_INTRIN_ENDPOINT3


572 
	#USB_CFG_HAVE_INTRIN_ENDPOINT3
 0

	)

575 
	#USB_BUFSIZE
 11

	)

579 #iâdeà
USB_INTR_CFG


580 #ià
defšed
 
EICRA


581 
	#USB_INTR_CFG
 
EICRA


	)

583 
	#USB_INTR_CFG
 
MCUCR


	)

586 #iâdeà
USB_INTR_CFG_SET


587 #ià
defšed
(
USB_COUNT_SOF
è|| defšed(
USB_SOF_HOOK
)

588 
	#USB_INTR_CFG_SET
 (1 << 
ISC01
è

	)

593 
	#USB_INTR_CFG_SET
 ((1 << 
ISC00
è| (1 << 
ISC01
)è

	)

596 #iâdeà
USB_INTR_CFG_CLR


597 
	#USB_INTR_CFG_CLR
 0

	)

600 #iâdeà
USB_INTR_ENABLE


601 #ià
defšed
 
GIMSK


602 
	#USB_INTR_ENABLE
 
GIMSK


	)

603 #–ià
defšed
 
EIMSK


604 
	#USB_INTR_ENABLE
 
EIMSK


	)

606 
	#USB_INTR_ENABLE
 
GICR


	)

609 #iâdeà
USB_INTR_ENABLE_BIT


610 
	#USB_INTR_ENABLE_BIT
 
INT0


	)

613 #iâdeà
USB_INTR_PENDING


614 #ià
defšed
 
EIFR


615 
	#USB_INTR_PENDING
 
EIFR


	)

617 
	#USB_INTR_PENDING
 
GIFR


	)

620 #iâdeà
USB_INTR_PENDING_BIT


621 
	#USB_INTR_PENDING_BIT
 
INTF0


	)

641 
	#USBPID_SETUP
 0x2d

	)

642 
	#USBPID_OUT
 0xe1

	)

643 
	#USBPID_IN
 0x69

	)

644 
	#USBPID_DATA0
 0xc3

	)

645 
	#USBPID_DATA1
 0x4b

	)

647 
	#USBPID_ACK
 0xd2

	)

648 
	#USBPID_NAK
 0x5a

	)

649 
	#USBPID_STALL
 0x1e

	)

651 #iâdeà
USB_INITIAL_DATATOKEN


652 
	#USB_INITIAL_DATATOKEN
 
USBPID_DATA1


	)

655 #iâdeà
__ASSEMBLER__


657 
	susbTxStus
 {

658 vŞ©
uch¬
 
	mËn
;

659 
uch¬
 
	mbufãr
[
USB_BUFSIZE
];

660 } 
	tusbTxStus_t
;

662 
usbTxStus_t
 
usbTxStus1
, 
usbTxStus3
;

663 
	#usbTxL’1
 
usbTxStus1
.
Ën


	)

664 
	#usbTxBuf1
 
usbTxStus1
.
bufãr


	)

665 
	#usbTxL’3
 
usbTxStus3
.
Ën


	)

666 
	#usbTxBuf3
 
usbTxStus3
.
bufãr


	)

669 
	uusbWÜd
 {

670 
	mwÜd
;

671 
uch¬
 
	mby‹s
[2];

672 } 
	tusbWÜd_t
;

674 
	susbReque¡
 {

675 
uch¬
 
	mbmReque¡Ty³
;

676 
uch¬
 
	mbReque¡
;

677 
usbWÜd_t
 
	mwV®ue
;

678 
usbWÜd_t
 
	mwIndex
;

679 
usbWÜd_t
 
	mwL’gth
;

680 } 
	tusbReque¡_t
;

692 
	#USBRQ_RCPT_MASK
 0x1f

	)

693 
	#USBRQ_RCPT_DEVICE
 0

	)

694 
	#USBRQ_RCPT_INTERFACE
 1

	)

695 
	#USBRQ_RCPT_ENDPOINT
 2

	)

698 
	#USBRQ_TYPE_MASK
 0x60

	)

699 
	#USBRQ_TYPE_STANDARD
 (0<<5)

	)

700 
	#USBRQ_TYPE_CLASS
 (1<<5)

	)

701 
	#USBRQ_TYPE_VENDOR
 (2<<5)

	)

704 
	#USBRQ_DIR_MASK
 0x80

	)

705 
	#USBRQ_DIR_HOST_TO_DEVICE
 (0<<7)

	)

706 
	#USBRQ_DIR_DEVICE_TO_HOST
 (1<<7)

	)

709 
	#USBRQ_GET_STATUS
 0

	)

710 
	#USBRQ_CLEAR_FEATURE
 1

	)

711 
	#USBRQ_SET_FEATURE
 3

	)

712 
	#USBRQ_SET_ADDRESS
 5

	)

713 
	#USBRQ_GET_DESCRIPTOR
 6

	)

714 
	#USBRQ_SET_DESCRIPTOR
 7

	)

715 
	#USBRQ_GET_CONFIGURATION
 8

	)

716 
	#USBRQ_SET_CONFIGURATION
 9

	)

717 
	#USBRQ_GET_INTERFACE
 10

	)

718 
	#USBRQ_SET_INTERFACE
 11

	)

719 
	#USBRQ_SYNCH_FRAME
 12

	)

722 
	#USBDESCR_DEVICE
 1

	)

723 
	#USBDESCR_CONFIG
 2

	)

724 
	#USBDESCR_STRING
 3

	)

725 
	#USBDESCR_INTERFACE
 4

	)

726 
	#USBDESCR_ENDPOINT
 5

	)

727 
	#USBDESCR_HID
 0x21

	)

728 
	#USBDESCR_HID_REPORT
 0x22

	)

729 
	#USBDESCR_HID_PHYS
 0x23

	)

732 
	#USBATTR_BUSPOWER
 0

	)

733 
	#USBATTR_SELFPOWER
 0x40

	)

734 
	#USBATTR_REMOTEWAKE
 0x20

	)

737 
	#USBRQ_HID_GET_REPORT
 0x01

	)

738 
	#USBRQ_HID_GET_IDLE
 0x02

	)

739 
	#USBRQ_HID_GET_PROTOCOL
 0x03

	)

740 
	#USBRQ_HID_SET_REPORT
 0x09

	)

741 
	#USBRQ_HID_SET_IDLE
 0x0a

	)

742 
	#USBRQ_HID_SET_PROTOCOL
 0x0b

	)

	@AVR_Code/usbdrv/usbportability.h

23 #iâdeà
__usbpÜb™y_h_INCLUDED__


24 
	#__usbpÜb™y_h_INCLUDED__


	)

29 #ià
defšed
 
__IAR_SYSTEMS_ICC__
 || defšed 
__IAR_SYSTEMS_ASM__


32 #iâdeà
ENABLE_BIT_DEFINITIONS


33 
	#ENABLE_BIT_DEFINITIONS
 1

	)

37 
	~<ißvr.h
>

38 #iâdeà
__IAR_SYSTEMS_ASM__


39 
	~<šavr.h
>

42 
	#__©Œibu‹__
(
¬g
è

	)

44 #ifdeà
__IAR_SYSTEMS_ASM__


45 
	#__ASSEMBLER__


	)

48 #ifdeà
__HAS_ELPM__


49 
	#PROGMEM
 
__çræash


	)

51 
	#PROGMEM
 
__æash


	)

54 
	#USB_READ_FLASH
(
addr
è(*(
PROGMEM
 *)×ddr))

	)

59 
	#şi
(è
	`__di§bË_š‹¼u±
()

	)

60 
	#£i
(è
	`__’abË_š‹¼u±
()

	)

61 
	#wdt_»£t
(è
	`__w©chdog_»£t
()

	)

62 
	#_BV
(
x
è(1 << (x))

	)

65 
	#nİ2
 
rjmp
 
$
+2

	)

66 
	#XL
 
r26


	)

67 
	#XH
 
r27


	)

68 
	#YL
 
r28


	)

69 
	#YH
 
r29


	)

70 
	#ZL
 
r30


	)

71 
	#ZH
 
r31


	)

72 
	#lo8
(
x
è
	`LOW
(x)

	)

73 
	#hi8
(
x
è(((x)>>8è& 0xffè

	)

84 #–ià
__CODEVISIONAVR__


90 
	~<io.h
>

91 
	~<d–ay.h
>

93 
	#__©Œibu‹__
(
¬g
è

	)

95 
	#PROGMEM
 
__æash


	)

96 
	#USB_READ_FLASH
(
addr
è(*(
PROGMEM
 *)×ddr))

	)

98 #iâdeà
__ASSEMBLER__


99 
šlše
 
	$şi
()

102 
	}
}

103 
šlše
 
	$£i
()

106 
	}
}

108 
	#_d–ay_ms
(
t
è
	`d–ay_ms
Ñ)

	)

109 
	#_BV
(
x
è(1 << (x))

	)

110 
	#USB_CFG_USE_SWITCH_STATEMENT
 1

	)

112 
	#maüo
 .
maüo


	)

113 
	#’dm
 .
’dmaüo


	)

114 
	#nİ2
 
rjmp
 .+0

	)

120 
	~<avr/io.h
>

121 #ifdeà
__ASSEMBLER__


122 
	#_VECTOR
(
N
è
__veùÜ_
 ## N

	)

124 
	~<avr/pgm¥aû.h
>

127 #ià
USB_CFG_DRIVER_FLASH_PAGE


128 
	#USB_READ_FLASH
(
addr
è
	`pgm_»ad_by‹_çr
((()
USB_CFG_DRIVER_FLASH_PAGE
 << 16è| ()×ddr))

	)

130 
	#USB_READ_FLASH
(
addr
è
	`pgm_»ad_by‹
×ddr)

	)

133 
	#maüo
 .
maüo


	)

134 
	#’dm
 .
’dm


	)

135 
	#nİ2
 
rjmp
 .+0

	)

140 #iâdeà
PRG_RDB


141 
	#PRG_RDB
(
addr
è
	`USB_READ_FLASH
×ddr)

	)

	@QtUsb/baseinfo.cpp

1 
	~"ba£šfo.h
"

	@QtUsb/baseinfo.h

1 #iâdeà
BASEINFO_H


2 
	#BASEINFO_H


	)

4 
	~<QSŒšg
>

5 
	~<QTextSŒ—m
>

7 şas 
	cBa£Info


9 
	m´iv©e
:

10 
QSŒšg
 
ss
;

11 
	mpublic
:

12 
Ba£Info
Ğ
QSŒšg
 
‹xt
 = "" )

14 
ss
 = 
‹xt
;

16 
	g‹m¶©e
<
ty³Çme
 
	gT
>

17 
	gBa£Info
& 
	gİ”©Ü
<<(
	gT
 &
	g–
)

19 
QTextSŒ—m
(
ss
è<< 
	g–
;

20  
	gthis
;

22 
QSŒšg
 
	$g‘
()

24  
ss
;

25 
	}
}

27 
	gsigÇls
:

28 
public
 
¦Ùs
:

31 şas 
	cE¼Ü
 : 
public
 
Ba£Info


33 
public
:

34 
E¼Ü
Ğ
QSŒšg
 
‹xt
 = "" ) : 
	$Ba£Info
(
‹xt
)

37 
	}
};

	@QtUsb/main-window.cpp

1 
	~"maš-wšdow.h
"

2 
	~"ui_mašwšdow.h
"

4 
	gMašWšdow
::
	$MašWšdow
(
QWidg‘
 *
·»Á
) :

5 
	`QMašWšdow
(
·»Á
),

6 
	`ui
(
Ãw
 
Ui
::
MašWšdow
),

8 
_usbCÚš”
 = 
Ãw
 
	`UsbCÚš”
(&
_log
);

9 
ui
->
	`£tupUi
(
this
);

10 
QSŒšgLi¡
 
usbLogLi¡
 = 
_log
.
	`¥l™
("\n");

11 
i
=0; i<
usbLogLi¡
.
	`size
(); i++) {

12 if(
usbLogLi¡
.
	`©
(
i
).
	`cÚšs
("Error")) {

13 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(
i
));

14 
ui
->
usbLi¡Widg‘
->
	`™em
(
i
)->
	`£tTextCŞÜ
(
Qt
::
»d
);

16 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(
i
));

17 
ui
->
usbLi¡Widg‘
->
	`™em
(
i
)->
	`£tTextCŞÜ
(
Qt
::
g»’
);

20 
	}
}

22 
	gMašWšdow
::~
	$MašWšdow
()

24 
d–‘e
 
ui
;

25 
d–‘e
 
_usbCÚš”
;

26 
	}
}

28 
	gMašWšdow
::
	$Ú_usbR–ßdPushBu‰Ú_şicked
()

30 
d–‘e
 
_usbCÚš”
;

31 
_log
.
	`ş—r
();

32 
_usbCÚš”
 = 
Ãw
 
	`UsbCÚš”
(&
_log
);

33 
QSŒšgLi¡
 
usbLogLi¡
 = 
_log
.
	`¥l™
("\n");

34 
ui
->
usbLi¡Widg‘
->
	`ş—r
();

35 
i
=0; i<
usbLogLi¡
.
	`size
(); i++) {

36 if(
usbLogLi¡
.
	`©
(
i
).
	`cÚšs
("Error")) {

37 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(
i
));

38 
ui
->
usbLi¡Widg‘
->
	`™em
(
i
)->
	`£tTextCŞÜ
(
Qt
::
»d
);

40 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(
i
));

41 
ui
->
usbLi¡Widg‘
->
	`™em
(
i
)->
	`£tTextCŞÜ
(
Qt
::
g»’
);

44 
	}
}

46 
	gMašWšdow
::
	$Ú_pushBu‰Ú_şicked
()

48 
QSŒšgLi¡
 
usbLogLi¡
 = 
_usbCÚš”
->
	`li¡NÚRoÙDeviûs
();

49 
ui
->
usbLi¡Widg‘
->
	`ş—r
();

50 
i
=0; i<
usbLogLi¡
.
	`size
(); i++) {

51 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(
i
));

53 
	}
}

55 
	gMašWšdow
::
	$Ú_pushBu‰Ú_wr™eToDev_şicked
()

57 
QSŒšgLi¡
 
usbLogLi¡
;

58 
QSŒšg
 
¡ršg
 =
_usbCÚš”
->
	`wr™eToDeviû
(
_şickedProduù
);

59 
usbLogLi¡
.
	`­³nd
("Info: \n" + 
¡ršg
);

60 
ui
->
usbLi¡Widg‘
->
	`ş—r
();

61 
ui
->
usbLi¡Widg‘
->
	`addI‹m
(
usbLogLi¡
.
	`©
(0));

62 
	}
}

64 
	gMašWšdow
::
	$Ú_usbLi¡Widg‘_şicked
(cÚ¡ 
QMod–Index
 &
šdex
)

66 
_şickedProduù
 = (
ui
->
usbLi¡Widg‘
->
	`™em
(
šdex
.
	`row
())->
	`‹xt
());

67 
ui
->
usbLi¡Widg‘
->
	`ş—r
();

68 
ui
->
usbLi¡Widg‘
->
	`addI‹ms
(
_usbCÚš”
->
	`g‘DeviûInfo
(
_şickedProduù
));

69 
	}
}

	@QtUsb/main-window.h

1 #iâdeà
MAINWINDOW_H


2 
	#MAINWINDOW_H


	)

4 
	~<QMašWšdow
>

5 
	~"usb-cÚš”.h
"

7 
Çme¥aû
 
	gUi


9 
şass
 
	gMašWšdow
;

12 şas 
	cMašWšdow
 : 
public
 
QMašWšdow


14 
Q_OBJECT


16 
public
:

17 
ex¶ic™
 
MašWšdow
(
QWidg‘
 *
·»Á
 = 0);

18 ~
MašWšdow
();

20 
´iv©e
 
	m¦Ùs
:

21 
Ú_usbR–ßdPushBu‰Ú_şicked
();

23 
Ú_pushBu‰Ú_şicked
();

25 
Ú_pushBu‰Ú_wr™eToDev_şicked
();

27 
Ú_usbLi¡Widg‘_şicked
(cÚ¡ 
QMod–Index
 &
šdex
);

29 
	m´iv©e
:

30 
Ui
::
MašWšdow
 *
ui
;

31 
QSŒšg
 
	m_log
;

32 
UsbCÚš”
* 
	m_usbCÚš”
;

33 
QSŒšg
 
	m_şickedProduù
;

	@QtUsb/usb-container.cpp

1 
	~"usb-cÚš”.h
"

3 
	gUsbCÚš”
::
	$UsbCÚš”
(
QSŒšg
 *
”rÜLog
è: 
	`_”rÜ
(0), 
	`_numOfDev
(0), 
	$_”rÜLog
(
”rÜLog
)

5 
_”rÜ
 = 
	`usbLibIn™
();

6 if(
_”rÜ
 < 0è
	`QTextSŒ—m
(
_”rÜLog
è<< "E¼Ü: In™Ÿlizšg†ibusb" << 
’dl
;

8 
_numOfDev
 = 
	`libusb_g‘_deviû_li¡
(
_ùx
, &
_deviû_li¡
);

9 ià(
_numOfDev
 < 1) {

10 
	`QTextSŒ—m
(
_”rÜLog
è<< "E¼Ü: NØdev found" << 
’dl
;

13 
ušt
 
i
=0; i<
_numOfDev
; i++) {

14 
_usbDeviûs
.
	`push_back
(
	`UsbDev
(
_deviû_li¡
[
i
],i,
”rÜLog
));

18 
	}
}

20 
	gUsbCÚš”
::~
	$UsbCÚš”
()

22 
	`libusb_ex™
(
_ùx
);

23 
	}
}

25 
	gUsbCÚš”
::
	$usbLibIn™
()

27 
ušt
 
”rÜ
;

28  
”rÜ
 = 
	`libusb_š™
(&
_ùx
);

29 
	}
}

33 
QSŒšgLi¡
 
	gUsbCÚš”
::
	$li¡NÚRoÙDeviûs
()

35 
QSŒšgLi¡
 
tmpLi¡
;

36 
i
=0; i<
_usbDeviûs
.
	`size
(); i++) {

37 if(
_usbDeviûs
.
	`©
(
i
).
	`isNÚSudoDev
()) {

38 
tmpLi¡
.
	`­³nd
(
_usbDeviûs
.
	`©
(
i
).
	`g‘ProduùSŒšg
());

41  
tmpLi¡
;

42 
	}
}

44 
QSŒšg
 
	gUsbCÚš”
::
	$wr™eToDeviû
(
QSŒšg
 &
´oduùSŒšg
)

46 
size_t
 
size
 = 
_usbDeviûs
.
	`size
(è, 
i
;

47 
i
 = 0; i<
size
; ++i) {

48 if(
_usbDeviûs
[
i
].
	`g‘ProduùSŒšg
(è=ğ
´oduùSŒšg
) {

52 if(
i
 =ğ
size
) {

57  
_usbDeviûs
[
i
].
	`š‹¼u±_Œªsãr
(
Endpošt
::
DœeùiÚ
::
Out
);

59 
	}
}

61 
QSŒšgLi¡
 
	gUsbCÚš”
::
	$g‘DeviûInfo
(
i
)

63 
QSŒšg
 
tmp
;

64 
	`QTextSŒ—m
(&
tmp
è<< 
_usbDeviûs
.
	`size
();

65 
QSŒšgLi¡
 
tmpLi¡
;

66 
tmpLi¡
.
	`­³nd
(
tmp
);

67 
	`QTextSŒ—m
(&
tmp
è<< 
i
;

68 
tmpLi¡
.
	`­³nd
(
tmp
);

69  
tmpLi¡
;

70 
	}
}

72 
QSŒšgLi¡
 
	gUsbCÚš”
::
	$g‘DeviûInfo
(
QSŒšg
 &
¡ršgi
)

74 
QSŒšgLi¡
 
tmp
;

75 
size_t
 
size
 = 
_usbDeviûs
.
	`size
(), 
i
;

76 
i
=0; i<
size
 ; ++i) {

77 if(
_usbDeviûs
[
i
].
	`g‘ProduùSŒšg
(è=ğ
¡ršgi
 ) {

81 if(
i
 =ğ
size
) {

82 
tmp
.
	`­³nd
("No such device");

84 
tmp
 = 
_usbDeviûs
[
i
].
	`devInfo
();

86  
tmp
;

87 
	}
}

	@QtUsb/usb-container.h

1 #iâdeà
USBCONTAINER_H


2 
	#USBCONTAINER_H


	)

3 
	~"usbdev.h
"

4 
	~<QVeùÜ
>

5 
	~<QTextSŒ—m
>

7 şas 
	cUsbCÚš”


9 
	m´iv©e
:

10 
QVeùÜ
<
UsbDev
> 
_usbDeviûs
;

11 
	m_”rÜ
;

12 
ušt
 
	m_numOfDev
;

13 
usbLibIn™
();

14 
QSŒšg
 *
	m_”rÜLog
;

15 
libusb_deviû
 **
	m_deviû_li¡
;

16 
libusb_cÚ‹xt
 *
	m_ùx
;

17 
	mpublic
:

18 
UsbCÚš”
(
QSŒšg
 *
”rÜLog
);

19 ~
UsbCÚš”
();

20 
QSŒšgLi¡
 
li¡NÚRoÙDeviûs
();

21 
wr™eToDeviû
(
ušt
 
i
, 
QSŒšg
 *
ohSh›t
=0);

22 
QSŒšg
 
wr™eToDeviû
(QSŒšg &
´oduùSŒšg
);

23 
QSŒšgLi¡
 
g‘DeviûInfo
(
i
);

24 
QSŒšgLi¡
 
g‘DeviûInfo
(
QSŒšg
 &
¡ršgi
);

	@QtUsb/usbdev.cpp

1 
	~"usbdev.h
"

2 
	~<QDebug
>

5 
	gEndpošt
::
	$Endpošt
()

7 
bL’gth
 = 0;

8 
bDesütÜTy³
 = 0;

9 
bEndpoštAdd»ss
 = 0;

10 
bmA‰ribu‹s
 = 0;

11 
wMaxPack‘Size
 = 0;

12 
bIÁ”v®
 = 0;

13 
bReäesh
 = 0;

14 
bSynchAdd»ss
 = 0;

15 
exŒa_Ëngth
 = 0;

16 
	}
}

17 
	gEndpošt
::
	$Endpošt
(cÚ¡ 
libusb_’dpošt_desütÜ
 *
’dpošt
è: 
	$libusb_’dpošt_desütÜ
(*
’dpošt
)

18 {
	}
}

20 
Endpošt
::
	$g‘bEndpoštAdd»ss
()

22  
bEndpoštAdd»ss
;

23 
	}
}

25 
	gEndpošt
::
	$deütÜSize
()

27  
bL’gth
;

28 
	}
}

30 
QSŒšg
 
	gEndpošt
::
	$dœeùiÚ
()

32 
	`qDebug
(è<< "dœ" << (
bEndpoštAdd»ss
&0x80);

33 
bEndpoštAdd»ss
&0x80) {

34 
LIBUSB_ENDPOINT_IN
:

39 
	}
}

41 
	gEndpošt
::
	$’dpoštNr
()

43  
bEndpoštAdd»ss
&0x07;

44 
	}
}

46 
	gEndpošt
::
	$maxPack‘Size
()

48  
wMaxPack‘Size
;

49 
	}
}

50 
	gEndpošt
::
	$pŞlštIÁ”v®
()

52  
bIÁ”v®
;

53 
	}
}

54 
	gEndpošt
::
	$»äeshF“dback
()

56  
bReäesh
;

57 
	}
}

58 
	gEndpošt
::
	$synchAdd»ss
()

60  
bSynchAdd»ss
;

61 
	}
}

63 
QSŒšgLi¡
 
	gEndpošt
::
	$·r£_bmA‰ribu‹s
()

65 
QSŒšgLi¡
 
tmp
;

66 
QSŒšg
 
tmpSŒ
 = "Transferype: ";

67 
bmA‰ribu‹s
&0x3) {

69 
tmpSŒ
 += "Control";

72 
tmpSŒ
+= "Isochronous";

75 
tmpSŒ
 += "Bulk";

78 
tmpSŒ
 += "Interrupt";

81 
tmp
.
	`­³nd
(
tmpSŒ
);

84 if((
bmA‰ribu‹s
&0x3) == 1) {

85 
tmpSŒ
 = "Sync.ype: ";

86 
bmA‰ribu‹s
&(3<<1)) {

88 
tmpSŒ
+= "No Synchonisation";

91 
tmpSŒ
+="Asynchronous";

94 
tmpSŒ
+= "Adaptive";

97 
tmpSŒ
+="Synchronous";

100 
tmp
.
	`­³nd
(
tmpSŒ
);

101 
tmpSŒ
 = "Usageype: ";

102 
bmA‰ribu‹s
&(2<<3)) {

104 
tmpSŒ
+= "Data Endpoint";

107 
tmpSŒ
+= "Feedback Endpoint";

110 
tmpSŒ
+="Explicit Feedback Data Endpoint";

113 
tmpSŒ
+="Reserved";

116 
tmp
.
	`­³nd
(
tmpSŒ
);

118  
	`QSŒšgLi¡
(
tmp
);

119 
	}
}

121 
boŞ
 
	gEndpošt
::
	$exi¡
() const

123  
	`boŞ
(

124 
bDesütÜTy³
 != 0xFF

125 && 
bEndpoštAdd»ss
 != 0xFF

126 && 
wMaxPack‘Size
 != 0

128 
	}
}

133 
	gAÉ”Ç‹S‘tšg
::
	$AÉ”Ç‹S‘tšg
()

135 
š‹rçû_desütÜ
.
bNumEndpošts
 = 0;

136 
	}
}

138 
	gAÉ”Ç‹S‘tšg
::
	$AÉ”Ç‹S‘tšg
(cÚ¡ 
libusb_š‹rçû_desütÜ
* 
toG‘
è: 
	$š‹rçû_desütÜ
(*
toG‘
)

141 * 
tmp
 = 
Ãw
 [ 
toG‘
->
exŒa_Ëngth
 + 1 ];

142 
	`¡ºıy
(
tmp
,(cÚ¡ *)(
toG‘
->
exŒa
),toG‘->
exŒa_Ëngth
);

143 
_exŒa
 = 
tmp
;

144 
d–‘e
[] 
tmp
;

146 
i
=0; i<
toG‘
->
bNumEndpošts
; ++i) {

147 
_’dpošt
.
	`push_back
(
toG‘
->
’dpošt
+
i
);

149 
	}
}

151 
	gAÉ”Ç‹S‘tšg
::~
	$AÉ”Ç‹S‘tšg
()

152 { 
	}
}

154 
boŞ
 
AÉ”Ç‹S‘tšg
::
	$exi¡
()

156  
š‹rçû_desütÜ
.
bNumEndpošts
?
Œue
:
çl£
;

157 
	}
}

159 
	gAÉ”Ç‹S‘tšg
::
	$š‹¿ûCÏss
()

161  
š‹rçû_desütÜ
.
bIÁ”çûCÏss
;

162 
	}
}

164 
Endpošt
 
	gAÉ”Ç‹S‘tšg
::
	$g‘Endpošt
(
Endpošt
::
DœeùiÚ
 
IO
)

166 
QSŒšg
 
tmp
;

167 ià(
IO
 =ğ
Endpošt
::
DœeùiÚ
::
In
 ) 
tmp
 = "In";

168 ià(
IO
 =ğ
Endpošt
::
DœeùiÚ
::
Out
 ) 
tmp
 = "Out";

169 
i
 = 0; i < 
_’dpošt
.
	`size
() ; ++i ) {

170 
	`qDebug
(è<< "’dpošˆdœ: " << 
_’dpošt
[
i
].
	`dœeùiÚ
();

171 ifĞ
_’dpošt
[
i
].
	`dœeùiÚ
(è=ğ
tmp
 ) {

172  
_’dpošt
[
i
];

175 
	`qDebug
() << "REALLY?";

176  
	`Endpošt
();

177 
	}
}

179 
Endpošt
 
	gAÉ”Ç‹S‘tšg
::
	$g‘Endpošt
(
Ä
è
	$throw
(
E¼Ü
)

181 if(!(
Ä
 < 
š‹rçû_desütÜ
.
bNumEndpošts
)) {

182 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"Endpoint does‚otƒxist");

184  
_’dpošt
[
Ä
];

186 
	}
}

188 
boŞ
 
	gAÉ”Ç‹S‘tšg
::
	$£tEndpošt
(
Endpošt
 
toPush
)

190 if(
_’dpošt
.
	`size
(è< 
š‹rçû_desütÜ
.
bNumEndpošts
) {

191 
_’dpošt
 +ğ
toPush
;

192  
Œue
;

194  
çl£
;

196 
	}
}

198 
QSŒšg
 
	gAÉ”Ç‹S‘tšg
::
	$IÁ”çûPrÙocŞ
()

200  
USBP¬£r
::
	`·r£DeviûCÏss
(
š‹rçû_desütÜ
.
bDesütÜTy³
);

201 
	}
}

203 
	gAÉ”Ç‹S‘tšg
::
	$g‘IÁ”çûNr
()

205  
š‹rçû_desütÜ
.
bIÁ”çûNumb”
;

206 
	}
}

210 
	gIÁ”çû
::
	$IÁ”çû
(è: 
	$_numOfAÉIÁ”çûs
(0)

211 {
	}
}

213 
IÁ”çû
::
	$IÁ”çû
(
numOfAÉIÁ”çûs
è: 
	$_numOfAÉIÁ”çûs
(
numOfAÉIÁ”çûs
)

214 {
	}
}

216 
IÁ”çû
::
	$IÁ”çû
(cÚ¡ 
libusb_š‹rçû
* 
toG‘
)

218 
_numOfAÉIÁ”çûs
 = 
toG‘
->
num_®t£‰šg
;

220 
i
=0; i<
_numOfAÉIÁ”çûs
; ++i) {

221 
AÉ”Ç‹S‘tšg
 
	`tmpAÉ”Ç‹S‘tšg
(
toG‘
->
®t£‰šg
);

222 
_®‹º©eS‘tšg
.
	`push_back
(
tmpAÉ”Ç‹S‘tšg
);

224 
	}
}

226 
QSŒšgLi¡
 
	gIÁ”çû
::
	$g‘IÁ”çûsNames
()

228 
QSŒšgLi¡
 
tmp
;

229 
i
=0; i<
_numOfAÉIÁ”çûs
; ++i) {

230 
tmp
.
	`­³nd
("\t->" + 
USBP¬£r
::
	`·r£DeviûCÏss
(
_®‹º©eS‘tšg
[
i
].
	`š‹¿ûCÏss
()));

232  
tmp
;

233 
	}
}

235 
AÉ”Ç‹S‘tšg
 
	gIÁ”çû
::
	$ãtchIÁ”çû
(
QSŒšg
 
Çme
)

237 autØ
™”
 = 
_®‹º©eS‘tšg
.
	`begš
();

238  
i
 = 0, 
max
=
_®‹º©eS‘tšg
.
	`size
();

239 
i
 < 
max
;

240 ++
i


242 iàĞ
Çme
 =ğ
USBP¬£r
::
	`·r£DeviûCÏss
(
™”
[
i
].
	`š‹¿ûCÏss
()) ) {

243  
™”
[
i
];

246  
	`AÉ”Ç‹S‘tšg
();

247 
	}
}

251 
QSŒšg
 
	gUSBP¬£r
::
	$·r£DeviûCÏss
(
code
)

253 
code
) {

254 
LIBUSB_CLASS_PER_INTERFACE
:

256 
LIBUSB_CLASS_AUDIO
:

258 
LIBUSB_CLASS_COMM
:

260 
LIBUSB_CLASS_HID
:

262 
LIBUSB_CLASS_PHYSICAL
:

264 
LIBUSB_CLASS_PRINTER
:

266 
LIBUSB_CLASS_PTP
:

268 
LIBUSB_CLASS_MASS_STORAGE
:

270 
LIBUSB_CLASS_DATA
:

272 
LIBUSB_CLASS_SMART_CARD
:

274 
LIBUSB_CLASS_CONTENT_SECURITY
:

276 
LIBUSB_CLASS_PERSONAL_HEALTHCARE
:

278 
LIBUSB_CLASS_DIAGNOSTIC_DEVICE
:

280 
LIBUSB_CLASS_WIRELESS
:

282 
LIBUSB_CLASS_APPLICATION
:

284 
LIBUSB_CLASS_VENDOR_SPEC
:

291 
	}
}

293 
QSŒšg
 
	gUSBP¬£r
::
	$·r£UsbE¼Ü
(
”rÜ
)

295  
”rÜ
) {

296 
LIBUSB_SUCCESS
:

298 
LIBUSB_ERROR_IO
:

300 
LIBUSB_ERROR_INVALID_PARAM
:

302 
LIBUSB_ERROR_ACCESS
:

304 
LIBUSB_ERROR_NO_DEVICE
:

306 
LIBUSB_ERROR_NOT_FOUND
:

308 
LIBUSB_ERROR_BUSY
:

310 
LIBUSB_ERROR_TIMEOUT
:

312 
LIBUSB_ERROR_OVERFLOW
:

314 
LIBUSB_ERROR_PIPE
:

316 
LIBUSB_ERROR_INTERRUPTED
:

318 
LIBUSB_ERROR_NO_MEM
:

320 
LIBUSB_ERROR_NOT_SUPPORTED
:

322 
LIBUSB_ERROR_OTHER
:

327 
	}
}

329 
	gUsbDev
::
	$UsbDev
(è: 
	`_isO³n
(
çl£
),

330 
	`_deviûNumb”
(
OUT_OF_USB_BUS
),

331 
	`_nÚSUdoDev
(0),

332 
	`_deviû
(0),

333 
	$_deviû_hªdË
(0)

334 { 
	}
}

336 
	gUsbDev
::
	$UsbDev
(
libusb_deviû
 *
deviû
,
devNr
,
QSŒšg
 *
”rÜLog
è: 
	`_isO³n
(
çl£
),

337 
	`_nÚSUdoDev
(
çl£
),

338 
	$_deviû
(
deviû
)

341 
¡ršg_bufãr_mªuçùu»r
[4096];

342 
¡ršg_bufãr_´oduù
[4096];

344 
”rÜ
=0;

345 
”rÜ
 = 
	`libusb_g‘_deviû_desütÜ
(
deviû
, &
_deviû_desütÜ
);

346 if(
”rÜ
 < 0) {

347 
	`QTextSŒ—m
(
”rÜLog
è<< "E¼Ü: FaedØg‘ desütÜ"<< 
’dl
;

349 
”rÜ
ğ
	`libusb_İ’
(
deviû
,&
_deviû_hªdË
);

350 if(
”rÜ
<0) {

351 
	`QTextSŒ—m
(
”rÜLog
) << "Error: Opening USB device‚r: "

352 << 
devNr


353 << 
’dl
;

355 
_isO³n
 = 1;

356 
”rÜ
 = 
	`libusb_g‘_¡ršg_desütÜ_ascii
(
_deviû_hªdË
,

357 
_deviû_desütÜ
.
iMªuçùu»r
,

358 
¡ršg_bufãr_mªuçùu»r
,

359 (
¡ršg_bufãr_mªuçùu»r
));

360 if(
”rÜ
 < 0) {

361 
	`QTextSŒ—m
(
”rÜLog
è<< "E¼Ü: CÚv”tšg desütÜØASCII [iMªuçùu»r]" << 
’dl
;

364 
”rÜ
 = 
	`libusb_g‘_¡ršg_desütÜ_ascii
(
_deviû_hªdË
,

365 
_deviû_desütÜ
.
iProduù
,

366 
¡ršg_bufãr_´oduù
,

367 (
¡ršg_bufãr_´oduù
));

368 if(
”rÜ
<0) {

370 
	`QTextSŒ—m
(
”rÜLog
è<< "E¼Ü: CÚv”tšg desütÜØASCII [iProduù]" <<
’dl
;

372 
	`QTextSŒ—m
(
”rÜLog
è<< "Sucûs! Deviû‡dded!" << 
’dl
;

373 
	`QTextSŒ—m
(&
_mªuçùu»r
è<< (cÚ¡ *)
¡ršg_bufãr_mªuçùu»r
;

374 
	`QTextSŒ—m
(&
_´oduù
è<< (cÚ¡ *)
¡ršg_bufãr_´oduù
;

375 
_deviûNumb”
 = 
devNr
;

376 
_deviû
 =
deviû
;

377 
_nÚSUdoDev
=
Œue
;

378 
_numOfCÚfigu¿tiÚs
 = 
_deviû_desütÜ
.
bNumCÚfigu¿tiÚs
;

379 
_idV’dÜ
 = 
_deviû_desütÜ
.
idV’dÜ
;

380 
_idProduù
 = 
_deviû_desütÜ
.
idProduù
;

382 
	`libusb_g‘_cÚfig_desütÜ
(
_deviû
, 0, &
_deviû_cÚfig
);

383 
_numOfIÁ”çûs
 = 
_deviû_cÚfig
->
bNumIÁ”çûs
;

384 
i
=0; i< 
_numOfIÁ”çûs
; i++) {

385 
IÁ”çû
 
	`tmpIÁ”çû
(
_deviû_cÚfig
->
š‹rçû
);

386 
_š‹rçû
.
	`push_back
(
tmpIÁ”çû
);

388 
_deviûCÏss
 = 
	`·r£DeviûCÏss
();

389 
	`libusb_ä“_cÚfig_desütÜ
(
_deviû_cÚfig
);

391 if(
_isO³n
 == 1) {

392 
	`libusb_şo£
(
_deviû_hªdË
);

393 
_isO³n
 = 0;

398 ià(
_isO³n
 == 1) {

399 
	`libusb_şo£
(
_deviû_hªdË
);

400 
_isO³n
 = 0;

403 
	}
}

405 
	gUsbDev
::~
	$UsbDev
()

407 
	`şo£
();

408 
	}
}

410 
	gUsbDev
::
	$İ’
(è
	$throw
(
E¼Ü
)

412 if(
_isO³n
) {

413  
Œue
;

415 
tmp
 = 
	`libusb_İ’
(
_deviû
, &
_deviû_hªdË
);

416 if(
tmp
 < 0) {

417 
_deviûLog
 << "Error: Opening USB device";

418 if(
_isU£rCÚÃùabË
 !ğ
çl£
) _isUserConnectable = false;

419 
_isO³n
 = 
çl£
;

420 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"Can't open USB device");

422 
¡
.
	`push
(
S‹
::
ST
::
O³Ãd
);

423 if(!
_isU£rCÚÃùabË
è_isU£rCÚÃùabË = 
Œue
;

424  (
_isO³n
 = 
Œue
);

426 
	}
}

428 
	gUsbDev
::
	$g‘NumOfPossibËCÚfigu¿tiÚs
()

430  
_numOfCÚfigu¿tiÚs
;

431 
	}
}

433 
	gUsbDev
::
	$g‘V’dÜID
()

435  
_idV’dÜ
;

436 
	}
}

437 
	gUsbDev
::
	$g‘ProduùID
()

439  
_idProduù
;

440 
	}
}

442 
QSŒšgLi¡
 
	gUsbDev
::
	$g‘DeviûCÏss
()

444  
_deviûCÏss
;

445 
	}
}

447 
libusb_deviû_hªdË
* 
	gUsbDev
::
	$g‘HªdË
(è
	$throw
(
E¼Ü
)

449 iàĞ
_deviû_hªdË
 ) {

450  
_deviû_hªdË
;

452 
E¼Ü
 
	`b
("No handle‡vailable");

453 
throw
 
b
;

455 
	}
}

457 
AÉ”Ç‹S‘tšg
 
	gUsbDev
::
	$g‘IÁ”çû
(
QSŒšg
 
’dpoštTy³
è
	$throw
(
E¼Ü
)

459 autØ
™”
 = 
_š‹rçû
.
	`begš
();

460  
i
=0; i< 
_š‹rçû
.
	`size
(); ++i ) {

461 
AÉ”Ç‹S‘tšg
 
tmp
 = 
™”
[
i
].
	`ãtchIÁ”çû
(
’dpoštTy³
);

462 ifĞ
tmp
.
	`exi¡
() ) {

463  
tmp
;

466 iàĞ
™”
 =ğ
_š‹rçû
.
	`’d
() ) {

467 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"No such interface");

470  
	`AÉ”Ç‹S‘tšg
();

471 
	}
}

474 
	gUsbDev
::
	$g‘Endpošt
(
QSŒšg
 
’dpoštTy³
, QSŒšg &
»suÉ
)

476 
»suÉ
 = "uninitialised";

477 ‡utØ
i
: 
_š‹rçû
 ) {

478 
AÉ”Ç‹S‘tšg
 
tmp
 = 
i
.
	`ãtchIÁ”çû
(
’dpoštTy³
);

479 ifĞ
tmp
.
	`exi¡
() ) {

480 
»suÉ
 = "success";

481  
tmp
.
	`g‘Endpošt
(0).
	`g‘bEndpoštAdd»ss
();

484 
»suÉ
 == "fail";

485 
a
='\0';

486  
a
;

487 
	}
}

489 
boŞ
 
	gUsbDev
::
	$isNÚSudoDev
() const

491  
_nÚSUdoDev
;

492 
	}
}

494 
QSŒšg
 
	gUsbDev
::
	$g‘ProduùSŒšg
() const

496  
_´oduù
;

497 
	}
}

499 
QSŒšg
 
	gUsbDev
::
	$g‘Mªuçùu»rSŒšg
() const

501  
_mªuçùu»r
;

502 
	}
}

504 
QSŒšgLi¡
 
	gUsbDev
::
	$devInfo
()

506 
QSŒšgLi¡
 
»tQSŒšgLi¡
;

507 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("Produù:\t\t"è+ 
	`g‘ProduùSŒšg
());

508 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("Mªuçùu»r:\t"è+ 
	`g‘Mªuçùu»rSŒšg
());

509 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("Device class:\t"));

510 
»tQSŒšgLi¡
.
	`­³nd
(
	`g‘DeviûCÏss
());

511 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("V’dÜ ID:\t\t"è+ QSŒšg("0x%1").
	`¬g
(
	`g‘V’dÜID
(),0,16));

512 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("ProduøID:\t\t"è+ QSŒšg("0x%1").
	`¬g
(
	`g‘ProduùID
(),0,16));

513 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("Num oàpossibË cÚfigu¿tiÚs:\t"è+ QSŒšg("%1").
	`¬g
(
	`g‘NumOfPossibËCÚfigu¿tiÚs
(),0,10));

514 
»tQSŒšgLi¡
.
	`­³nd
(
	`QSŒšg
("Num oàdeviû iÁ”çû is:\t"è+QSŒšg("%1").
	`¬g
(
_numOfIÁ”çûs
,0,10));

515  
»tQSŒšgLi¡
;

516 
	}
}

519 
	$¿w_š‹¼u±_Œªsãr
Ğ
libusb_deviû_hªdË
 *
hªdË
,

520 
Endpošt
::
DœeùiÚ
 
IO
,

521 *
buf
,

522 
size_t
 
buf_Ën
,

523 &
aù_Ën
,

524 
timeout


525 è
	$throw
(
E¼Ü
)

527 
nBy‹s
 = 
	`libusb_š‹¼u±_Œªsãr
Ğ
hªdË
,

528 
IO
,

529 
buf
,

530 
buf_Ën
,

531 &
aù_Ën
,

532 
timeout


534 iàĞ
nBy‹s
 < 0 )

535 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
è+
USBP¬£r
::
	`·r£UsbE¼Ü
(
nBy‹s
));

536 
	}
}

538 
	$¿w_»Ëa£_š‹rçû
Ğ
libusb_deviû_hªdË
 *
hªdË
, 
ušt8_t
 
•Nr
 ) 
	$throw
(
E¼Ü
)

540 
»t
 = 
	`libusb_»Ëa£_š‹rçû
Ğ
hªdË
,
•Nr
);

541 iàĞ
»t
 < 0 ) {

542 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
è+ 
USBP¬£r
::
	`·r£UsbE¼Ü
(
»t
));

544 
	}
}

546 
	$¿w_şo£
(
libusb_deviû_hªdË
 *
hªdË
)

548 
	`libusb_şo£
(
hªdË
);

549 
	}
}

553 
QSŒšg
 
	gUsbDev
::
	$š‹¼u±_Œªsãr
Ğ
Endpošt
::
DœeùiÚ
 
IO
, cÚ¡ 
timeout
)

555 
boŞ
 
£t_me_abÏze
 = 
Œue
;

556 
bufãr
[2] = { 0xff,0xff };

557 
bufãr
[1] = 
£t_me_abÏze
;

558 
aù_Ën
;

560 
Œy
 {

561 
this
->
	`İ’
();

562 
AÉ”Ç‹S‘tšg
 
tmpIÁ
 = 
this
->
	`g‘IÁ”çû
("HID");

563 
this
->
	`checkAndD‘achK”ÃlDriv”
Ñhis->
	`g‘HªdË
(),
tmpIÁ
.
	`g‘IÁ”çûNr
());

564 
this
->
	`şaim_š‹rçû
Ğthis->
	`g‘HªdË
(), 
tmpIÁ
.
	`g‘IÁ”çûNr
() );

565 
this
->
	`checkBuffÜ
Ğ(
bufãr
),
tmpIÁ
.
	`g‘Endpošt
(
Endpošt
::
DœeùiÚ
::
Out
).
	`maxPack‘Size
(), Endpoint::Direction::Out );

566 
	`¿w_š‹¼u±_Œªsãr
(
this
->
	`g‘HªdË
(), 
IO
, 
bufãr
, (bufãr), 
aù_Ën
, 
timeout
 );

567 ià(
£t_me_abÏze
 =ğ
Œue
) {

568 
£t_me_abÏze
 = 
çl£
;

570 
£t_me_abÏze
 = 
Œue
;

572 
	`ä“S‹s
();

573 } 
	`ÿtch
 (
E¼Ü
 &
”r
) {

574 
	`ä“S‹s
();

575  
”r
.
	`g‘
();

578 
	}
}

581 
QSŒšg
 
	gUsbDev
::
	$cÚŒŞl_Œªsãr
(
Endpošt
::
DœeùiÚ
 
IO
, * 
buãr
, 
size_t
 
buf_size
, cÚ¡ 
timeout
 )

583 
	`libusb_cÚŒŞ_Œªsãr
(

584 
this
->
	`g‘HªdË
(),

585 
LIBUSB_REQUEST_TYPE_VENDOR
 | 
LIBUSB_RECIPIENT_DEVICE
 | 
LIBUSB_ENDPOINT_OUT
,

586 
IO
,

589 (*)
buãr
,

590 
buf_size
,

591 
timeout


593 
	}
}

595 
	gUsbDev
::
	$şo£
()

597 if(
_isO³n
) {

598 
	`¿w_şo£
(
this
->
	`g‘HªdË
());

599  (
_isO³n
 = 
çl£
);

601  (
_isO³n
 = 
Œue
);

603 
	}
}

605 
	gUsbDev
::
	$deCÏim
(è
	$throw
(
E¼Ü
)

607 
	`¿w_»Ëa£_š‹rçû
(
this
->
	`g‘HªdË
(), 
¡
.
	`pİInNr
() );

608 
	}
}

609 
boŞ
 
	gUsbDev
::
	$ä“S‹s
()

611 
Œy
 {

612 
S‹
::
ST
 
tmp
 = 
¡
.
	`pİ
();

613 ; 
tmp
 !ğ
S‹
::
ST
::
NÚe
;m°ğ
¡
.
	`pİ
() ) {

614  
tmp
 ) {

615 
S‹
::
ST
::
NÚe
:

617 
S‹
::
ST
::
O³Ãd
:

618 
	`şo£
();

620 
S‹
::
ST
::
CÏimed
:

621 
	`deCÏim
();

624 
	`qDebug
() << "Success!";

628 } 
	`ÿtch
 ( 
E¼Ü
 &
”r
 ) {

629 
	`qDebug
() << "What do do‚ow?";

630 
	`qDebug
(è<< 
”r
.
	`g‘
();

631  
çl£
;

633  
Œue
;

634 
	}
}

638 
QSŒšgLi¡
 
	gUsbDev
::
	$·r£DeviûCÏss
()

640 
QSŒšgLi¡
 
tmp
;

641 if(
_deviû_desütÜ
.
bDeviûCÏss
 =ğ
LIBUSB_CLASS_PER_INTERFACE
) {

642 
i
=0; i<
_deviû_desütÜ
.
bNumCÚfigu¿tiÚs
; ++i) {

643 
tmp
.
	`­³nd
(
_š‹rçû
[
i
].
	`g‘IÁ”çûsNames
());

646 
tmp
.
	`­³nd
(
USBP¬£r
::
	`·r£DeviûCÏss
(
_deviû_desütÜ
.
bDeviûCÏss
));

648  
tmp
;

649 
	}
}

651 
	gUsbDev
::
	$checkAndD‘achK”ÃlDriv”
(
libusb_deviû_hªdË
* 
hªdË
, 
ušt8_t
 
š‹rçûNr
 )

653 iàĞ
	`libusb_k”Ãl_driv”_aùive
(
hªdË
, 
š‹rçûNr
 ) =ğ
Œue
 ) {

654 
	`libusb_d‘ach_k”Ãl_driv”
(
hªdË
, 
š‹rçûNr
 );

656 
	}
}

662 
	gUsbDev
::
	$checkBuffÜ
Ğ
size_t
 
buffSize
, size_ˆ
eBuffSize
, 
Endpošt
::
DœeùiÚ
 
IO
 ) 
	$throw
(
E¼Ü
)

664 iàĞ
buffSize
 > 
eBuffSize
 && 
IO
 =ğ
Endpošt
::
DœeùiÚ
::
In
 ) {

665 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"Bufforoo big forransfer");

666 } ià(
buffSize
 < 
eBuffSize
 && 
IO
 =ğ
Endpošt
::
DœeùiÚ
::
Out
 ) {

667 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"Bufforoo small forransfer");

669 
	}
}

671 
	gUsbDev
::
	$şaim_š‹rçû
(
libusb_deviû_hªdË
* 
hªdË
, 
•Nr
 ) 
	$throw
(
E¼Ü
)

673 iàĞ
	`libusb_şaim_š‹rçû
(
hªdË
,
•Nr
) < 0 ) {

674 
throw
 
	`E¼Ü
Ğ
	`QSŒšg
(
__PRETTY_FUNCTION__
) +"Can‚ot claim interface");

676 
¡
.
	`push
(
•Nr
);

678 
	}
}

	@QtUsb/usbdev.h

1 #iâdeà
USBDEV_H


2 
	#USBDEV_H


	)

4 
	~<libusb-1.0/libusb.h
>

5 
	~<QSŒšg
>

6 
	~<QSŒšgLi¡
>

7 
	~<QT¿n¦©Ü
>

8 
	~<QTextSŒ—m
>

9 
	~<QVeùÜ
>

10 
	~<QLi¡
>

11 
	~"ba£šfo.h
"

12 
	~<QDebug
>

17 
Çme¥aû
 
	gUSBP¬£r


19 
QSŒšg
 
·r£DeviûCÏss
(
code
);

20 
QSŒšg
 
·r£UsbE¼Ü
(
”rÜ
);

26 şas 
	cEndpošt
 : 
public
 
libusb_’dpošt_desütÜ


28 
´iv©e
:

29 
QSŒšg
 
exŒa_
;

30 
	mpublic
:

31 
	eDœeùiÚ
 {

32 
In
 = 0,

33 
	mOut
 = 1,

35 
Endpošt
();

36 
Endpošt
(cÚ¡ 
libusb_’dpošt_desütÜ
 *
’dpošt
);

37 
g‘bEndpoštAdd»ss
();

38 
deütÜSize
();

39 
QSŒšg
 
dœeùiÚ
();

40 
’dpoštNr
();

41 
maxPack‘Size
();

42 
pŞlštIÁ”v®
();

43 
»äeshF“dback
();

44 
synchAdd»ss
();

45 
QSŒšgLi¡
 
·r£_bmA‰ribu‹s
();

46 
boŞ
 
	$exi¡
() const;

47 
	}
};

49 şas 
	cAÉ”Ç‹S‘tšg


51 
	m´iv©e
:

52 
libusb_š‹rçû_desütÜ
 
š‹rçû_desütÜ
;

53 
	mQVeùÜ
<
	mEndpošt
> 
	m_’dpošt
;

54 
QSŒšg
 
	m_exŒa
;

55 
	mpublic
:

56 
AÉ”Ç‹S‘tšg
();

57 
AÉ”Ç‹S‘tšg
(cÚ¡ 
libusb_š‹rçû_desütÜ
* 
toG‘
);

58 ~
AÉ”Ç‹S‘tšg
();

59 
boŞ
 
exi¡
();

60 
š‹¿ûCÏss
();

61 
Endpošt
 
	$g‘Endpošt
(
Ä
è
	`throw
(
E¼Ü
);

62 
Endpošt
 
	`g‘Endpošt
(Endpošt::
DœeùiÚ
 
IO
);

63 
boŞ
 
	`£tEndpošt
(
Endpošt
 
toPush
);

64 
QSŒšg
 
	`IÁ”çûPrÙocŞ
();

65 
	`g‘IÁ”çûNr
();

71 şas 
	cIÁ”çû


73 
´iv©e
:

74 
_numOfAÉIÁ”çûs
;

75 
QVeùÜ
<
AÉ”Ç‹S‘tšg
> 
_®‹º©eS‘tšg
;

77 
public
:

78 
	`IÁ”çû
();

79 
	`IÁ”çû
(
numOfAÉIÁ”çûs
);

80 
	`IÁ”çû
(cÚ¡ 
libusb_š‹rçû
* 
toG‘
);

81 
QSŒšgLi¡
 
	`g‘IÁ”çûsNames
();

82 
AÉ”Ç‹S‘tšg
 
	`ãtchIÁ”çû
(
QSŒšg
 
Çme
);

89 şas 
	cUsbDev


92 
OUT_OF_USB_BUS
 = 128,

95 
public
:

96 
	`UsbDev
();

97 
	`UsbDev
(
libusb_deviû
 *
deviû
, 
devNr
, 
QSŒšg
 *
”rÜLog
);

98 ~
	`UsbDev
();

100 şas 
	cS‹


102 
´iv©e
:

103 
QVeùÜ
<> 
š‹rçûsNrCÏimed
;

104 
public
:

105 
	eST
 {

106 
NÚe
 = 0,

107 
O³Ãd
,

108 
CÏimed
,

110 
ST
 
	`pİ
()

112 iàĞ
¡©e
.
	`isEm±y
() ) {

113  
NÚe
;

115 
ST
 
tmp
 = 
¡©e
.
	`back
();

116 
¡©e
.
	`pİ_back
();

117  
tmp
;

120 
	`push
(
S‹
::
ST
 
¡
)

122 
¡©e
.
	`push_back
(
¡
);

125 
	`push
(
š‹rçûNr
)

127 
¡©e
.
	`push_back
(
S‹
::
ST
::
CÏimed
);

128 
š‹rçûsNrCÏimed
.
	`push_back
(
š‹rçûNr
);

131 
	`pİInNr
()

133 
tmp
 = 
š‹rçûsNrCÏimed
.
	`back
();

134 
š‹rçûsNrCÏimed
.
	`pİ_back
();

135  
tmp
;

138 
	`S‹
() { }

139 
´iv©e
:

140 
QLi¡
<
ST
> 
¡©e
;

141 
	}
};

143 
S‹
 
	g¡
;

144 
	$İ’
(è
	`throw
(
E¼Ü
);

145 
	`şo£
();

147 
	`g‘NumOfPossibËCÚfigu¿tiÚs
();

148 
	`g‘V’dÜID
();

149 
	`g‘ProduùID
();

150 
QSŒšgLi¡
 
	`g‘DeviûCÏss
();

151 
	`g‘CÚfigDesütÜ
();

153 
libusb_deviû_hªdË
 *
	$g‘HªdË
(è
	`throw
(
E¼Ü
);

154 
AÉ”Ç‹S‘tšg
 
	$g‘IÁ”çû
(
QSŒšg
 
’dpoštTy³
è
	`throw
(
E¼Ü
);

155 
	`g‘Endpošt
(
QSŒšg
 
’dpoštTy³
, QSŒšg &
»suÉ
);

156 
boŞ
 
	$isNÚSudoDev
() const;

158 
QSŒšg
 
	$g‘ProduùSŒšg
() const;

159 
QSŒšg
 
	$g‘Mªuçùu»rSŒšg
() const;

160 
QSŒšgLi¡
 
	`devInfo
();

161 
QSŒšgLi¡
 
	`g‘CÚfigD©a
();

162 
QSŒšg
 
	`š‹¼u±_Œªsãr
(
Endpošt
::
DœeùiÚ
 
IO
, cÚ¡ 
timeout
=5000 );

163 
QSŒšg
 
	`cÚŒŞl_Œªsãr
(
Endpošt
::
DœeùiÚ
 
IO
, * 
buãr
, 
size_t
 
buf_size
, cÚ¡ 
timeout
=5000 );

165 
	$deCÏim
(è
	`throw
(
E¼Ü
);

166 
boŞ
 
	`ä“S‹s
();

168 
´iv©e
:

169 
QSŒšgLi¡
 
	`·r£DeviûCÏss
();

170 
	`checkAndD‘achK”ÃlDriv”
(
libusb_deviû_hªdË
* 
hªdË
, 
ušt8_t
 
š‹rçûNr
 );

171 
	$checkBuffÜ
Ğ
size_t
 
buffSize
, size_ˆ
eBuffSize
, 
Endpošt
::
DœeùiÚ
 
IO
 ) 
	`throw
(
E¼Ü
);

172 
	$şaim_š‹rçû
(
libusb_deviû_hªdË
* 
hªdË
, 
•Nr
 ) 
	`throw
(
E¼Ü
);

174 
_isO³n
;

175 
_deviûNumb”
;

176 
boŞ
 
_nÚSUdoDev
;

177 
libusb_deviû
 *
_deviû
;

178 
libusb_deviû_hªdË
 *
_deviû_hªdË
;

179 
libusb_deviû_desütÜ
 
_deviû_desütÜ
;

180 
libusb_cÚfig_desütÜ
 *
_deviû_cÚfig
;

181 
QVeùÜ
<
IÁ”çû
> 
_š‹rçû
;

182 
QSŒšgLi¡
 
_deviûCÏss
;

183 
QSŒšg
 
_mªuçùu»r
;

184 
QSŒšg
 
_´oduù
;

185 
_numOfCÚfigu¿tiÚs
;

186 
_idV’dÜ
;

187 
_idProduù
;

188 
_numOfIÁ”çûs
;

189 
_numb”OfAÉ”Ç‹S‘tšgs
;

190 
_numb”OfEndpošts
;

192 
boŞ
 
_isU£rCÚÃùabË
;

193 
QSŒšgLi¡
 
_deviûLog
;

195 
	}
};

	@main.cpp

1 
	~<QtGui
>

2 
	~"mašwšdow.h
"

3 
	~<QtWidg‘s/QAµliÿtiÚ
>

5 
	$maš
(
¬gc
, *
¬gv
[])

7 
QAµliÿtiÚ
 
	`a
(
¬gc
, 
¬gv
);

8 
MašWšdow
 
w
;

9 
w
.
	`show
();

11  
a
.
	`exec
();

12 
	}
}

	@mainwindow.cpp

1 
	~"mašwšdow.h
"

2 
	~"ui_mašwšdow.h
"

3 
	~<libusb-1.0/libusb.h
>

4 
	~<qwt/qwt_¶Ù_curve.h
>

5 
	~<QVeùÜ
>

7 
	~"‹mpTabË.h
"

9 
	gpwm
, 
	gpwm_mš
, 
	gpwm_max
;

10 
	g‹mp
,
	g‹mp_mš
, 
	g‹mp_max
;

11 
	g´İ
, 
	g´İ_mš
, 
	g´İ_maxp
;

12 
	gš‹g
, 
	gš‹g_mš
, 
	gš‹g_max
;

13 
	gd”iv
, 
	gd”iv_mš
, 
	gd”iv_max
;

16 
	#USB_DATA_OUT
 2

17 
	#USB_DATA_IN
 4

18 

	)

20 
uch¬
 
	gbufãr
[8]= {0,0,0,0,0,0,0};

21 
	ebufãrBy‹
 {

22 
	mFÏg
,
	mTempYoungADC
,
	mTempOldADC
,
	mTempYoungS‘
,
	mTempOldS‘
,
	mPID_P
,
	mPID_I
,
	mPID_D


26 
	gtimeSecs
=1;

27 
	gQVeùÜ
<> 
PlÙTempD©a
(
QVeùÜ
<>(100));

28 
	gQVeùÜ
<> 
PlÙTempS‘
(
QVeùÜ
<>(100));

29 
	gQVeùÜ
<> 
PlÙTime
(
QVeùÜ
<>(100));

31 
	$R•ÜtE¼Ü
Ğ
QLi¡Widg‘
 *
Ú
, 
QSŒšg
 &
¡r
 ) {

32 
Ú
->
	`addI‹m
(
¡r
);

33 
Ú
->
	`™em
(Ú->
	`couÁ
(è- 1)->
	`£tFÜeground
(
Qt
::
wh™e
);

34 
Ú
->
	`™em
(Ú->
	`couÁ
(è- 1)->
	`£tBackground
(
Qt
::
»d
);

35 
	}
}

37 
	$´štNÚRoÙUSBDevs
Ğ
QLi¡Widg‘
 *
li¡Widg‘
, 
UsbCÚš”
 &
usbCÚš”
) {

38 
li¡Widg‘
->
	`ş—r
();

39 
li¡Widg‘
->
	`addI‹ms
(
usbCÚš”
.
	`li¡NÚRoÙDeviûs
());

40 
	}
}

43 
	gMašWšdow
::
	$MašWšdow
(
QWidg‘
 *
·»Á
) :

44 
	`QMašWšdow
(
·»Á
),

45 
	`ui
(
Ãw
 
Ui
::
MašWšdow
),

46 
	`usbcÚš”
(
Ãw
 
	$UsbCÚš”
(&
usbE¼ÜLog
))

48 
ui
->
	`£tupUi
(
this
);

50 
TimmšgV®ue
=0;

51 
	`£tWšdowT™Ë
("Fila Controll");

53 
bufãr
[0]=0;

56 
CurvePlÙTempD©a
 = 
Ãw
 
	`QwtPlÙCurve
("Real 1");

57 
CurvePlÙTempS‘
 = 
Ãw
 
	`QwtPlÙCurve
("Set 2");

60 
ui
->
qwtPlÙ
->
	`£tT™Ë
("Set‡nd„ealemp");

61 
ui
->
qwtPlÙ
->
	`£tAxisT™Ë
Ğ
QwtPlÙ
::
yLeá
 ,"Temp [*C]");

62 
ui
->
qwtPlÙ
->
	`£tAxisT™Ë
Ğ
QwtPlÙ
::
xBÙtom
, "Time [s] ");

63 
CurvePlÙTempD©a
->
	`£tSam¶es
(
PlÙTime
,
PlÙTempD©a
);

64 
CurvePlÙTempD©a
->
	`£tP’
Ğ
	`QP’
(
Qt
::
»d
));

65 
CurvePlÙTempS‘
->
	`£tSam¶es
(
PlÙTime
,
PlÙTempS‘
);

66 
CurvePlÙTempS‘
->
	`£tP’
Ğ
	`QP’
(
Qt
::
blue
));

67 
CurvePlÙTempD©a
->
	`©ch
(
ui
->
qwtPlÙ
);

68 
CurvePlÙTempS‘
->
	`©ch
(
ui
->
qwtPlÙ
);

71 
ui
->
dŸl_Temp
->
	`£tMaximum
(250);

72 
ui
->
dSpšBox_Temp
->
	`£tMaximum
(250);

73 
ui
->
dŸl_PWM
->
	`£tMaximum
(100);

74 
ui
->
dSpšBox_PWM
->
	`£tMaximum
(100);

76 
ui
->
qwtPlÙ
->
	`»¶Ù
();

79 
ui
->
‹xtBrow£rLOG
->
	`addI‹ms
(
usbE¼ÜLog
.
	`¥l™
("\n"));

80 
	`´štNÚRoÙUSBDevs
Ğ
ui
->
li¡Widg‘
, *
usbcÚš”
);

86 
ReguÏtiÚTy³
=0;

87 
	}
}

89 
	gMašWšdow
::~
	$MašWšdow
()

91 
	`klTim”
(
tim”Id
);

92 
d–‘e
 
ui
;

93 
	}
}

95 
	gMašWšdow
::
	$Ú_dŸl_PWM_¦id”Moved
(
pos™iÚ
)

97 
pwm
=
pos™iÚ
;

98 
ui
->
dSpšBox_PWM
->
	`£tV®ue
(
pwm
);

99 
	}
}

100 
	gMašWšdow
::
	$Ú_dŸl_Temp_¦id”Moved
(
pos™iÚ
)

102 
‹mp
=
pos™iÚ
;

103 
ui
->
dSpšBox_Temp
->
	`£tV®ue
(
‹mp
);

104 
	}
}

106 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_P_¦id”Moved
(
pos™iÚ
)

108 
´İ
=
pos™iÚ
;

109 
ui
->
dSpšBox_P
->
	`£tV®ue
(
´İ
);

110 
	}
}

111 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_P_v®ueChªged
(
v®ue
)

113 
´İ
=
v®ue
;

114 
ui
->
dSpšBox_P
->
	`£tV®ue
(
´İ
);

116 
	}
}

117 
	gMašWšdow
::
	$Ú_dSpšBox_P_v®ueChªged
(
¬g1
)

119 
´İ
=
¬g1
;

120 
ui
->
v”tiÿlSlid”_P
->
	`£tSlid”Pos™iÚ
((
¬g1
));

121 
	}
}

123 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_I_¦id”Moved
(
pos™iÚ
)

125 
š‹g
=
pos™iÚ
;

126 
ui
->
dSpšBox_I
->
	`£tV®ue
(
š‹g
);

127 
	}
}

128 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_I_v®ueChªged
(
v®ue
)

130 
š‹g
=
v®ue
;

131 
ui
->
dSpšBox_I
->
	`£tV®ue
(
š‹g
);

132 
	}
}

133 
	gMašWšdow
::
	$Ú_dSpšBox_I_v®ueChªged
(
¬g1
)

135 
š‹g
=
¬g1
;

136 
ui
->
v”tiÿlSlid”_I
->
	`£tV®ue
(
š‹g
);

137 
	}
}

139 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_D_¦id”Moved
(
pos™iÚ
)

141 
d”iv
=
pos™iÚ
;

142 
ui
->
dSpšBox_D
->
	`£tV®ue
(
d”iv
);

143 
	}
}

144 
	gMašWšdow
::
	$Ú_v”tiÿlSlid”_D_v®ueChªged
(
v®ue
)

146 
d”iv
=
v®ue
;

147 
ui
->
dSpšBox_D
->
	`£tV®ue
(
d”iv
);

148 
	}
}

149 
	gMašWšdow
::
	$Ú_dSpšBox_D_v®ueChªged
(
¬g1
)

151 
d”iv
=
¬g1
;

152 
ui
->
v”tiÿlSlid”_D
->
	`£tV®ue
(
d”iv
);

153 
	}
}

156 
	gMašWšdow
::
	$li¡v›w_pİuÏ‹_usb_deviûs
()

159 
	`´štNÚRoÙUSBDevs
Ğ
ui
->
li¡Widg‘
, *
usbcÚš”
);

160 
	}
}

162 
	gMašWšdow
::
	$Ú_li¡Widg‘_şicked
(cÚ¡ 
QMod–Index
 &
šdex
)

167 
	}
}

169 
MašWšdow
::
	$¶ÙCh¬t
Ğ
T_£t
, 
aùu®_time
, 
T_m—su»d
 )

171 
PlÙTempD©a
.
	`š£¹
(PlÙTempD©a.
	`size
(), 
T_£t
 );

172 
PlÙTime
.
	`š£¹
(PlÙTime.
	`size
(), 
aùu®_time
 );

173 
PlÙTempS‘
.
	`š£¹
(PlÙTempS‘.
	`size
(), 
T_m—su»d
 );

175 
CurvePlÙTempD©a
->
	`£tSam¶es
(
PlÙTime
,
PlÙTempD©a
);

176 
CurvePlÙTempD©a
->
	`£tP’
Ğ
	`QP’
(
Qt
::
»d
));

177 
CurvePlÙTempS‘
->
	`£tSam¶es
(
PlÙTime
,
PlÙTempS‘
);

178 
CurvePlÙTempS‘
->
	`£tP’
Ğ
	`QP’
(
Qt
::
blue
));

179 
ui
->
qwtPlÙ
->
	`»¶Ù
();

180 
	}
}

190 
	gMašWšdow
::
	$tim”Ev’t
(
QTim”Ev’t
 *
ev’t
)

192 if((
bufãr
[
FÏg
]==1è&& (
ReguÏtiÚTy³
!=0)) {

194 
‹mpToS‘
 = 
ReguÏtiÚTy³
->
	`»tuºTemp
(
TimmšgV®ue
,
‹mp
);

196 
u_št16_t
 
‹mp_to_deviû
 = 
	`‹mp_to_£nd
(
‹mpToS‘
);

197 
bufãr
[
TempYoungS‘
]=
‹mp_to_deviû
&0xFF;

198 
bufãr
[
TempOldS‘
] =(
‹mp_to_deviû
>>8)&0xFF;

199 
bufãr
[
PID_P
]=(
u_št8_t
)
´İ
;

200 
bufãr
[
PID_I
]=(
u_št8_t
)
š‹g
;

201 
bufãr
[
PID_D
]=(
u_št8_t
)
d”iv
;

211 
	`¶ÙCh¬t
(
‹mpToS‘
, 
timeSecs
++, 
	`‹mp_fšd
Ğ
bufãr
[
TempYoungADC
] | (bufãr[
TempOldADC
]<<8) ) );

216 
	}
}

223 
	gMašWšdow
::
	$Ú_pushBu‰Ú_£nd_şicked
()

231 
tim”Id
 = 
	`¡¬tTim”
(1000);

232 if(
ReguÏtiÚTy³
==0) {

235 
bufãr
[
FÏg
]=1;

238 
u_št16_t
 
‹mp_to_deviû
 = 
	`‹mp_to_£nd
(
ReguÏtiÚTy³
->
	`»tuºTemp
(0,
‹mp
));

239 
bufãr
[
TempYoungS‘
]=
‹mp_to_deviû
&0xFF;

240 
bufãr
[
TempOldS‘
] =(
‹mp_to_deviû
>>8)&0xFF;

241 
bufãr
[
PID_P
]=(
u_št8_t
)
´İ
;

242 
bufãr
[
PID_I
]=(
u_št8_t
)
š‹g
;

243 
bufãr
[
PID_D
]=(
u_št8_t
)
d”iv
;

254 
	}
}

256 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_şicked
()

258 
d–‘e
 
ReguÏtiÚTy³
;

259 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Inhis setup simpleemp curve is sendo deviceoƒasily solider on halogen†amp-oven. \n"

262 
ReguÏtiÚTy³
 = 
Ãw
 
S‘upSŞid”šg
;

263 
	}
}

265 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_bi¡©e_şicked
()

267 
d–‘e
 
ReguÏtiÚTy³
;

268 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Inhis setup controller is operating‡s bistate controller,emperature is being set in"

270 
ReguÏtiÚTy³
 = 
Ãw
 
S‘upBi¡©e
;

271 
	}
}

273 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_Œi¡©e_şicked
()

275 
d–‘e
 
ReguÏtiÚTy³
;

276 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Inhis setup controller is operating‡sristate controller,emperature is being set in"

278 
ReguÏtiÚTy³
 = 
Ãw
 
S‘upTri¡©e
;

279 
	}
}

281 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_‹mpCheck_şicked
()

283 
d–‘e
 
ReguÏtiÚTy³
;

284 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Inhis setup controller is operating‡shermometer with constantemperature…lot");

285 
ReguÏtiÚTy³
 = 
Ãw
 
S‘upTempCheck
;

286 
	}
}

289 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_‹mpCurve_şicked
()

291 
d–‘e
 
ReguÏtiÚTy³
;

292 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Inhis setupƒxternalemperature curve is used - is shall be‚amed dataCurve.txt. \n"

295 
ReguÏtiÚTy³
 = 
Ãw
 
S‘upExtTempCurv
;

296 
	}
}

298 
	gMašWšdow
::
	$Ú_¿dioBu‰Ú_2_şicked
()

300 
d–‘e
 
ReguÏtiÚTy³
;

301 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Not supported yet.");

302 
	}
}

304 
	gMašWšdow
::
	$Ú_pushBu‰Ú_lßdFe_şicked
()

306 if(
ReguÏtiÚTy³
!=0) {

307 
QSŒšg
 
feName
 = 
QFeDŸlog
::
	`g‘O³nFeName
(
this
, 
	`Œ
("Open File"),

309 
	`Œ
("Text (*.txt *.TXT)"));

310 
ReguÏtiÚTy³
->
	`chªgeFeName
(
feName
);

313 
ui
->
‹xtBrow£r_£Ëù
->
	`£tText
("Noneype of work selected");

315 
	}
}

	@mainwindow.h

1 #iâdeà
MAINWINDOW_H


2 
	#MAINWINDOW_H


	)

4 
	~<QtWidg‘s/QMašWšdow
>

5 
	~<QtWidg‘s/QLi¡Widg‘
>

6 
	~<QTime
>

7 
	~<QVeùÜ
>

8 
	~<QtWidg‘s/QFeDŸlog
>

9 
	~"qwt/qwt_¶Ù_curve.h
"

10 
	~"£tup.h
"

11 
	~"£tupbi¡©e.h
"

12 
	~"£tu³x‰empcurv.h
"

13 
	~"£tu±empcheck.h
"

14 
	~"£tu±ri¡©e.h
"

15 
	~"£tupsŞid”šg.h
"

17 
	~<memÜy
>

18 
	~"QtUsb/usb-cÚš”.h
"

20 
Çme¥aû
 
	gUi


22 
şass
 
	gMašWšdow
;

25 şas 
	cMašWšdow
 : 
public
 
QMašWšdow


27 
Q_OBJECT


29 
public
:

30 
ex¶ic™
 
MašWšdow
(
QWidg‘
 *
·»Á
 = 0);

31 ~
MašWšdow
();

32 
S‘up
 *
	mReguÏtiÚTy³
;

33 
	mTimmšgV®ue
;

35 
public
 
	m¦Ùs
:

36 
li¡v›w_pİuÏ‹_usb_deviûs
();

38 
´iv©e
 
	m¦Ùs
:

39 
Ú_dŸl_PWM_¦id”Moved
(
pos™iÚ
);

40 
Ú_dŸl_Temp_¦id”Moved
(
pos™iÚ
);

41 
Ú_v”tiÿlSlid”_P_¦id”Moved
(
pos™iÚ
);

42 
Ú_v”tiÿlSlid”_I_¦id”Moved
(
pos™iÚ
);

43 
Ú_v”tiÿlSlid”_D_¦id”Moved
(
pos™iÚ
);

44 
Ú_dSpšBox_P_v®ueChªged
(
¬g1
);

45 
Ú_dSpšBox_I_v®ueChªged
(
¬g1
);

46 
Ú_dSpšBox_D_v®ueChªged
(
¬g1
);

47 
Ú_v”tiÿlSlid”_P_v®ueChªged
(
v®ue
);

48 
Ú_v”tiÿlSlid”_I_v®ueChªged
(
v®ue
);

49 
Ú_v”tiÿlSlid”_D_v®ueChªged
(
v®ue
);

51 
Ú_li¡Widg‘_şicked
(cÚ¡ 
QMod–Index
 &
šdex
);

53 
tim”Ev’t
(
QTim”Ev’t
 *
ev’t
);

54 
Ú_pushBu‰Ú_£nd_şicked
();

55 
Ú_¿dioBu‰Ú_şicked
();

56 
Ú_¿dioBu‰Ú_bi¡©e_şicked
();

57 
Ú_¿dioBu‰Ú_Œi¡©e_şicked
();

58 
Ú_¿dioBu‰Ú_‹mpCheck_şicked
();

59 
Ú_¿dioBu‰Ú_‹mpCurve_şicked
();

60 
Ú_¿dioBu‰Ú_2_şicked
();

61 
Ú_pushBu‰Ú_lßdFe_şicked
();

63 
	m´iv©e
:

64 
Ui
::
MašWšdow
 *
ui
;

66 
	mtim”Id
;

68 
QwtPlÙCurve
 *
	mCurvePlÙTempD©a
;

69 
QwtPlÙCurve
 *
	mCurvePlÙTempS‘
;

70 
¶ÙCh¬t
Ğ
T_£t
, 
aùu®_time
, 
T_m—su»d
 );

72 
QSŒšg
 
	musbE¼ÜLog
;

73 
	m¡d
::
unique_±r
<
UsbCÚš”
> 
usbcÚš”
;

	@setup.cpp

1 
	~"£tup.h
"

3 
	gS‘up
::~
	$S‘up
()

5 
	}
}

7 
S‘up
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

9 
	}
}

	@setup.h

1 #iâdeà
SETUP_H


2 
	#SETUP_H


	)

9 
	~<QSŒšg
>

11 şas 
	cS‘up


13 
	mpublic
:

14 ’um {
Sim¶eCurve
,
	mBi¡©eReg
,
	mTri¡©eReg
,
	mTempCheck
,
	mEx‹ºCurve
} 
	gS‘Ty³
;

16 
	gvœtu®
 ~
S‘up
();

17 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

18 
vœtu®
 
	$chªgeFeName
(
QSŒšg
è{
	}
};

	@setupbistate.cpp

1 
	~"£tupbi¡©e.h
"

3 
	gS‘upBi¡©e
::
	$S‘upBi¡©e
()

6 
	}
}

8 
S‘upBi¡©e
::~
	$S‘upBi¡©e
()

11 
	}
}

13 
S‘upBi¡©e
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

15 
pos™iÚ
=position;

16 
pos™iÚ
=0;

17  
pos™iÚ
;

18 
	}
}

	@setupbistate.h

1 #iâdeà
SETUPBISTATE_H


2 
	#SETUPBISTATE_H


	)

4 
	~"£tup.h
"

6 şas 
	cS‘upBi¡©e
 : 
public
 
S‘up


8 
public
:

9 
S‘upBi¡©e
();

10 ~
S‘upBi¡©e
();

11 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

12 
vœtu®
 
	$chªgeFeName
(
QSŒšg
) {};

13 
	}
};

	@setupexttempcurv.cpp

1 
	~"£tu³x‰empcurv.h
"

3 
	gS‘upExtTempCurv
::
	$S‘upExtTempCurv
()

5 
feIsS‘
=0;

6 
feName
="0";

7 
FeToR—d
.
	`£tFeName
("dataCurve.txt");

8 
d©aR—dyFÏg
 = 
FeToR—d
.
	`İ’
(
QIODeviû
::
R—dWr™e
);

9 if(!
d©aR—dyFÏg
);

10 
šputD©a
 = 
Ãw
 
	`QTextSŒ—m
(&
FeToR—d
);

11 
	}
}

13 
	gS‘upExtTempCurv
::~
	$S‘upExtTempCurv
()

15 
d–‘e
 
šputD©a
;

16 
	}
}

18 
	gS‘upExtTempCurv
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

20 if(!
feName
.
	`com·»
("0"));

21 ià(
feIsS‘
==0) {

22 
d–‘e
 
šputD©a
;

23 
FeToR—d
.
	`»£t
();

24 
FeToR—d
.
	`£tFeName
(
feName
);

25 
d©aR—dyFÏg
 = 
FeToR—d
.
	`İ’
(
QIODeviû
::
R—dWr™e
);

26 if(!
d©aR—dyFÏg
);

27 
šputD©a
 = 
Ãw
 
	`QTextSŒ—m
(&
FeToR—d
);

28 
feIsS‘
=1;

31 
QSŒšg
 
lše
;

32 
»tuºV®
=0;

33 if(!
d©aR—dyFÏg
) {

34 
»tuºV®
=100;

36 if(!
šputD©a
->
	`©End
()) {

37 
lše
 = 
šputD©a
->
	`»adLše
(10);

38 
	`qDebug
(è<<"Newlši \n" << 
lše
;

41 if(!
lše
.
	`com·»
("end")) {

42 
»tuºV®
=0;

43 
	`qDebug
()<<"End";

44 } if(!
lše
.
	`com·»
("start")) {

45 
»tuºV®
=0;

46 
	`qDebug
()<<"Start\n";

48 
	`qDebug
()<<"Conversion: ";

49 
»tuºV®
=
lše
.
	`toDoubË
();

50 
	`qDebug
()<<
»tuºV®
<<"\n";

53  
»tuºV®
;

54 
	}
}

	@setupexttempcurv.h

1 #iâdeà
SETUPEXTTEMPCURV_H


2 
	#SETUPEXTTEMPCURV_H


	)

4 
	~"£tup.h
"

5 
	~<QtCÜe/QFe
>

6 
	~<QtCÜe/QTextSŒ—m
>

7 
	~<QtCÜe/QSŒšg
>

8 
	~<QDebug
>

12 şas 
	cS‘upExtTempCurv
 : 
public
 
S‘up


14 
public
:

15 
S‘upExtTempCurv
();

16 ~
S‘upExtTempCurv
();

17 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

18 
vœtu®
 
	$chªgeFeName
(
QSŒšg
 
Name
)

20 
feName
=
Name
;

23 
´iv©e
:

24 
QFe
 
FeToR—d
;

25 
QTextSŒ—m
 *
šputD©a
;

26 
d©aR—dyFÏg
;

27 
QSŒšg
 
feName
;

28 
feIsS‘
;

29 
	}
};

	@setuppidcontroll.cpp

1 
	~"£tuµidcÚŒŞl.h
"

3 
	gS‘upPidCÚŒŞl
::
	$S‘upPidCÚŒŞl
()

5 
	}
}

7 
S‘upPidCÚŒŞl
::~
	$S‘upPidCÚŒŞl
()

10 
	}
}

12 
S‘upPidCÚŒŞl
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

14 
v®ToR‘
=0;

15  
v®ToR‘
;

16 
	}
}

	@setuppidcontroll.h

1 #iâdeà
SETUPPIDCONTROLL_H


2 
	#SETUPPIDCONTROLL_H


	)

4 
	~"£tup.h
"

6 şas 
	cS‘upPidCÚŒŞl
 : 
public
 
S‘up


8 
public
:

9 
S‘upPidCÚŒŞl
();

10 ~
S‘upPidCÚŒŞl
();

11 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

12 
vœtu®
 
	$chªgeFeName
(
QSŒšg
) {};

13 
	}
};

	@setupsolidering.cpp

1 
	~"£tupsŞid”šg.h
"

3 
	gS‘upSŞid”šg
::
	$S‘upSŞid”šg
()

5 
‹mpToR‘uº
=20;

6 
	}
}

8 
	gS‘upSŞid”šg
::~
	$S‘upSŞid”šg
()

11 
	}
}

13 
S‘upSŞid”šg
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

17 if(
pos™iÚ
<80è
‹mpToR‘uº
++;

18 if(
pos™iÚ
<140è
‹mpToR‘uº
=100;

19 if(
pos™iÚ
<280è
‹mpToR‘uº
++;

20 if(
pos™iÚ
<340);

21 if(
pos™iÚ
<440è
‹mpToR‘uº
--;

22 if(
‹mpToR‘uº
==0)empToReturn=0;

23  
‹mpToR‘uº
;

24 
	}
}

	@setupsolidering.h

1 #iâdeà
SETUPSOLIDERING_H


2 
	#SETUPSOLIDERING_H


	)

4 
	~"£tup.h
"

6 şas 
	cS‘upSŞid”šg
 : 
public
 
S‘up


8 
public
:

9 
S‘upSŞid”šg
();

10 ~
S‘upSŞid”šg
();

11 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

12 
vœtu®
 
	$chªgeFeName
(
QSŒšg
) {};

14 
´iv©e
:

15 
‹mpToR‘uº
;

16 
	}
};

	@setuptempcheck.cpp

1 
	~"£tu±empcheck.h
"

3 
	gS‘upTempCheck
::
	$S‘upTempCheck
()

5 
	}
}

7 
S‘upTempCheck
::~
	$S‘upTempCheck
()

10 
	}
}

12 
S‘upTempCheck
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

14 
pos™iÚ
=position;

15 
pos™iÚ
=0;

16 
»tuºV®
=
‹mpV®ue
;

17  
»tuºV®
=0;

18 
	}
}

	@setuptempcheck.h

1 #iâdeà
SETUPTEMPCHECK_H


2 
	#SETUPTEMPCHECK_H


	)

4 
	~"£tup.h
"

6 şas 
	cS‘upTempCheck
 : 
public
 
S‘up


8 
public
:

9 
S‘upTempCheck
();

10 ~
S‘upTempCheck
();

11 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

12 
vœtu®
 
	$chªgeFeName
(
QSŒšg
) {};

13 
	}
};

	@setuptristate.cpp

1 
	~"£tu±ri¡©e.h
"

3 
	gS‘upTri¡©e
::
	$S‘upTri¡©e
()

5 
	}
}

7 
S‘upTri¡©e
::~
	$S‘upTri¡©e
()

10 
	}
}

12 
S‘upTri¡©e
::
	$»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 )

14  
‹mpV®ue
;

15 
	}
}

	@setuptristate.h

1 #iâdeà
SETUPTRISTATE_H


2 
	#SETUPTRISTATE_H


	)

4 
	~"£tup.h
"

6 şas 
	cS‘upTri¡©e
 : 
public
 
S‘up


8 
public
:

9 
S‘upTri¡©e
();

10 ~
S‘upTri¡©e
();

11 
vœtu®
 
»tuºTemp
(
pos™iÚ
 ,
‹mpV®ue
 );

12 
vœtu®
 
	$chªgeFeName
(
QSŒšg
) {};

13 
	}
};

	@tempTable.h

1 #iâdeà
TEMPTABLE_H


2 
	#TEMPTABLE_H


	)

3 
	~<QVeùÜ
>

20 
u_št16_t
 
	g‹mpTabË
[]= {

26 
u_št8_t
 
	gd–tTabË
[]= {

31 
	$‹mp_fšd
(
ušt16_t
 
ADC
)

33 
‹m³¿tu»
=0;

34 
i
=0;

35 
‹mpTabË
[
i
]>
ADC
)

36 
i
++;

42 
muÉly
;

43 if(
d–tTabË
[
i
]) {

44 
muÉly
 = 5/()(
d–tTabË
[
i
]);

46 
muÉly
 = 0;

48 
‹m³¿tu»
ğ
i
*5 + (
ADC
 - 
‹mpTabË
[i])*
muÉly
;

49  
‹m³¿tu»
;

50 
	}
}

52 
u_št16_t
 
	$‹mp_to_£nd
(
‹mp
)

60 
š‹g¿l
 = (
ušt
)(
‹mp
)/5;

61 
hund»th
 = 
‹mp
 - (
ušt
)temp;

62 
u_št16_t
 
‹mp_to_S‘
 = 
‹mpTabË
[
š‹g¿l
] + 
d–tTabË
[š‹g¿l]*
hund»th
/5;

63  
‹mp_to_S‘
;

64 
	}
}

	@usbdevcon.cpp

1 
	~"usbdevcÚ.h
"

3 
	gUsbDevCÚ
::
	$UsbDevCÚ
(
š_dev_numb”
)

5 
i
=0; i<8; i++) {

6 
bufãr
[
i
]=0;

8 
dev_numb”
=
š_dev_numb”
;

9 if(0 > 
	`libusb_İ’
(
deviû
[
dev_numb”
],&
deviû_hªdË
)è
dev_İ’
 = -1;

11 
dev_İ’
=1;

12 
imªuçùu»r
 = 
	`libusb_g‘_¡ršg_desütÜ_ascii
(
deviû_hªdË
,
deviû_desütÜ
.
iMªuçùu»r
,
¡ršg_bufãr_mªuçùu»r
,(string_buffer_manufacturer));

13 if(0 > 
	`libusb_g‘_¡ršg_desütÜ_ascii
(
deviû_hªdË
,
deviû_desütÜ
.
iProduù
,
¡ršg_bufãr_´oduù
,(¡ršg_bufãr_´oduù)èè
desc_to_asci
=-1;

15 
desc_to_asci
 = 1;

17 
cc_mªuçùu»r
 = (cÚ¡ *)
¡ršg_bufãr_mªuçùu»r
;

18 
mªuçùu»r
 = 
cc_mªuçùu»r
;

20 
cc_´oduù
 = (cÚ¡ *)
¡ršg_bufãr_´oduù
;

21 
´oduù
 = 
cc_´oduù
;

24 
	}
}

26 
	gUsbDevCÚ
::~
	$UsbDevCÚ
()

28 
	`libusb_şo£
(
deviû_hªdË
);

29 
	}
}

	@usbdevcon.h

1 #iâdeà
USBSIMPLECONT_H


2 
	#USBSIMPLECONT_H


	)

4 
	~<libusb-1.0/libusb.h
>

5 
	~<QSŒšg
>

18 şas 
	cUsbDevCÚ


20 
	mpublic
:

21 
UsbDevCÚ
(
š_dev_numb”
);

22 ~
UsbDevCÚ
();

23 
usbCÚeù
();

25 
£ndHidD©a
(
u_št8_t
* 
d©a_bË
,u_št8_ˆ
Ënght
);

27 
	m´iv©e
:

28 
dev_numb”
;

29 
	m”rÜ_æag
 , 
	mdev_İ’
, 
	mdesc_to_asci
, 
	mimªuçùu»r
;

30 
QSŒšg
 
	mmªuçùu»r
,
	m´oduù
;

31 
libusb_deviû_hªdË
 *
	mdeviû_hªdË
;

32 
libusb_deviû_desütÜ
 
	mdeviû_desütÜ
;

33 
libusb_deviû
 **
	mdeviû
;

34 
libusb_cÚ‹xt
 *
	mùx
;

35 
	m¡ršg_bufãr_mªuçùu»r
[4096];

36 
	m¡ršg_bufãr_´oduù
[4096];

37 cÚ¡ *
	mcc_mªuçùu»r
;

38 cÚ¡ *
	mcc_´oduù
;

39 
uch¬
 
	mbufãr
[8];

	@
1
.
0
39
716
AVR_Code/adc.c
AVR_Code/adc.h
AVR_Code/ascii.h
AVR_Code/main.c
AVR_Code/temptable.h
AVR_Code/usbdrv/oddebug.c
AVR_Code/usbdrv/oddebug.h
AVR_Code/usbdrv/usbconfig.h
AVR_Code/usbdrv/usbdrv.c
AVR_Code/usbdrv/usbdrv.h
AVR_Code/usbdrv/usbportability.h
QtUsb/baseinfo.cpp
QtUsb/baseinfo.h
QtUsb/main-window.cpp
QtUsb/main-window.h
QtUsb/usb-container.cpp
QtUsb/usb-container.h
QtUsb/usbdev.cpp
QtUsb/usbdev.h
main.cpp
mainwindow.cpp
mainwindow.h
setup.cpp
setup.h
setupbistate.cpp
setupbistate.h
setupexttempcurv.cpp
setupexttempcurv.h
setuppidcontroll.cpp
setuppidcontroll.h
setupsolidering.cpp
setupsolidering.h
setuptempcheck.cpp
setuptempcheck.h
setuptristate.cpp
setuptristate.h
tempTable.h
usbdevcon.cpp
usbdevcon.h
